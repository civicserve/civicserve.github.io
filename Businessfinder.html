<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Regional Business Finder</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Mulish Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
  <!-- React and ReactDOM CDNs -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel CDN for in-browser JSX transformation -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    :root {
      --c-primary: 0, 55, 96; /* Blue color in RGB matching header #003760 */
      --c-landing-primary: 0, 55, 96;
      --c-landing-light20-primary-color: #1a4a7a;
      --c-landing-light30-primary-color: #2d5d8d;
      --c-landing-light35-primary-color: #3a6a9a;
      --c-landing-light40-primary-color: #4777a7;
      --c-landing-darken10-primary-color: #002040;
      --c-landing-secondary: #ffa800;
      --c-primary-contrast: #003760;
      --c-font-primary: #333333;
      --c-font-secondary: #6b7280;
      --c-card-background: #ffffff;
      --c-background: #f8f9fa;
      --c-success: #9CB1C1;
      --c-danger: #F44336;
      --c-warning: #f0ad4e;
      --dim-header-height: 60px;
    }
    
    body {
      font-family: 'Mulish', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: var(--c-background);
      padding: 0;
      margin: 0;
      min-height: 100vh;
    }
    
    /* Header styles */
    .header-content-wrapper {
      background-color: #003760;
      color: white;
      height: var(--dim-header-height);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1001;
    }
    
    .header-wrapper {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 1rem;
      height: 100%;
    }
    
    .header-left-wrapper {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .header-left-wrapper img {
      height: 30px;
    }
    
    .header-right svg, .header-left-wrapper svg {
      width: 20px;
      height: 20px;
      color: white;
      cursor: pointer;
    }
    
    .header-right .btn-link {
      color: white;
    }
    
    .header-right .btn-link:hover, .side-nav-toggle-btn:hover {
      opacity: 0.8;
    }
    
    /* Side Navigation Styles */
    .side-nav {
      position: fixed;
      top: var(--dim-header-height);
      left: 0;
      width: 240px;
      height: calc(100vh - var(--dim-header-height));
      background-color: white;
      color: #333;
      z-index: 1000;
      overflow-y: auto;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
    }
    
    .side-nav-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .side-nav-list li {
      position: relative;
    }
    
    .menu-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      color: #333;
      text-decoration: none;
      transition: background-color 0.2s ease;
      cursor: pointer;
      border-left: 4px solid transparent;
      font-size: 13px;
      line-height: 1.4;
    }
    
    .menu-item:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }
    
    .menu-item.active {
      background-color: #003760;
      color: white;
      border-left: 4px solid #003760;
      font-weight: 500;
    }
    
    .sub-menu .menu-item.active {
      background-color: #003760;
      color: white;
      border-left: 4px solid #003760;
      padding-left: 45px;
      font-weight: 500;
    }
    
    .sub-menu .menu-item {
      padding-left: 45px;
      padding-top: 8px;
      padding-bottom: 8px;
      font-size: 12px;
    }
    
    .menu-icon {
      margin-right: 12px;
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }
    
    .menu-label {
      flex-grow: 1;
    }
    
    .action-icon {
      transition: transform 0.2s ease;
      width: 12px !important;
      height: 12px !important;
      margin-left: auto;
    }
    
    .sub-menu {
      list-style: none;
      padding-left: 0;
      margin: 0;
      display: none;
      background-color: rgba(0, 0, 0, 0.02);
    }
    
    .sub-menu-show {
      display: block;
    }
    
    .side-nav-toggle-btn {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      padding: 8px;
      margin-right: 5px;
    }
    
    .side-nav-toggle-btn svg {
      width: 24px;
      height: 24px;
    }
    
    .content-wrapper {
      margin-left: 240px;
      margin-top: var(--dim-header-height);
      transition: margin-left 0.3s ease;
      min-height: calc(100vh - var(--dim-header-height));
      background-color: var(--c-background);
    }
    
    .content-wrapper.no-nav {
      margin-left: 0;
    }
    
    .overlay-effect {
      display: none;
      position: fixed;
      top: var(--dim-header-height);
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 999;
    }
    
    /* User details styling */
    .user-details-wrapper {
      cursor: pointer;
      padding: 5px;
      border-radius: 4px;
      transition: background-color 0.2s ease;
    }
    
    .user-details-wrapper:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    .name-initial-container {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background-color: #9CB1C1;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.9rem;
    }
    
    .user-details {
      margin-left: 10px;
    }
    
    .user-name {
      font-weight: bold;
      font-size: 0.9rem;
      line-height: 1.2;
    }
    
    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      line-height: 1.2;
    }
    
    /* Search styling */
    .search-wrapper {
      display: flex;
      flex-grow: 1;
      max-width: 600px;
      margin: 0 20px;
    }
    
    .search-input {
      position: relative;
      flex-grow: 1;
    }
    
    .search-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: #6b7280;
      z-index: 1;
    }
    
    .search-input input {
      padding-left: 35px;
      background-color: rgba(255, 255, 255, 0.9);
      border: none;
    }
    
    .search-input input:focus {
      background-color: white;
      box-shadow: 0 0 0 0.2rem rgba(var(--c-primary), 0.25);
    }
    
    .select-dropdown {
      width: 100px;
    }
    
    .select-dropdown select {
      height: 100%;
      border: none;
      background-color: rgba(255, 255, 255, 0.9);
    }
    
    .select-dropdown select:focus {
      background-color: white;
      box-shadow: 0 0 0 0.2rem rgba(var(--c-primary), 0.25);
    }
    
    /* Loading indicator styles */
    .linear-activity {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      z-index: 1002;
      background-color: rgba(var(--c-primary), 0.2);
      overflow: hidden;
    }
    
    .linear-activity .indeterminate {
      position: relative;
      width: 100%;
      height: 100%;
    }
    
    .linear-activity .indeterminate:before {
      content: '';
      position: absolute;
      height: 100%;
      background-color: rgb(var(--c-primary));
      animation: indeterminate 1.5s infinite ease-in-out;
      width: 30%;
    }
    
    @keyframes indeterminate {
      0% { left: -30%; }
      100% { left: 100%; }
    }
    
    /* Responsive design */
    @media (max-width: 992px) {
      .content-wrapper {
        margin-left: 0;
      }
      
      .side-nav {
        transform: translateX(-100%);
      }
      
      .search-wrapper {
        display: none;
      }
    }
    /* Custom animation for alert */
    @keyframes fade-in-down {
      from {
        opacity: 0;
        transform: translate(-50%, -20px);
      }
      to {
        opacity: 1;
        transform: translate(-50%, 0);
      }
    }
    .animate-fade-in-down {
      animation: fade-in-down 0.3s ease-out forwards;
    }
    /* Style for the search input to match screenshots */
    .search-input-mockup {
      background-color: #f7f9fa; /* Lighter background to match screenshots */
      border: 1px solid #d4dbe3; /* Softer border color */
      padding-left: 2.5rem; /* Space for search icon */
    }
    .search-input-mockup::placeholder {
      color: #9aa8b5;
      text-align: center; /* Center the placeholder text */
    }
    /* Style for the filter card inputs */
    .filter-input {
      background-color: #f7f9fa;
      border: 1px solid #d4dbe3;
      padding: 0.5rem 0.75rem;
    }
    /* Custom style for the table to match screenshots */
    .table-container {
      border: 1px solid #e2e8f0;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      /* Make the table container horizontally scrollable on smaller screens */
      overflow-x: auto;
    }
    .table-header {
      background-color: #f8fafc;
      border-bottom: 1px solid #e2e8f0;
    }
    /* Sidebar styling to match the screenshot */
    .sidebar {
      background-color: #2e4a6d;
      color: #b1bccd;
    }
    /* Main content styling to match the screenshot */
    .main-content {
      background-color: #f4f7f9;
      padding: 1.5rem;
    }
    /* Button styles to match the screenshots */
    .button-primary {
      background-color: #1a73e8; /* Blue like the screenshots */
      color: white;
      font-weight: 500;
      border-radius: 0.375rem;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
    .button-secondary {
      background-color: #f5f5f5;
      color: #424242;
      font-weight: 500;
      border: 1px solid #e0e0e0;
      border-radius: 0.375rem;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
    /* Table row hover effect */
    .table-row-hover:hover {
      background-color: #f3f4f6;
    }
    
    /* Filter sections */
    .filter-section {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 15px;
      align-items: center;
      padding: 15px;
      background-color: var(--c-background);
      border-radius: 5px;
      border: 1px solid #e5e7eb;
    }
    
    .filter-label {
      font-weight: 600;
      color: var(--c-font-primary);
      font-size: 0.75rem;
      margin-right: 8px;
      margin-bottom: 5px;
      display: block;
    }
    
    /* Form controls */
    .filter-select, .filter-input {
      border: 1px solid #ddd;
      padding: 8px 12px;
      border-radius: 4px;
      background-color: #fff;
      font-size: 0.875rem;
      color: var(--c-font-primary);
      transition: all 0.15s ease-in-out;
      min-width: 120px;
    }
    
    .filter-select:focus, .filter-input:focus {
      outline: none;
      border-color: rgb(var(--c-primary));
      box-shadow: 0 0 0 2px rgba(var(--c-primary), 0.2);
    }
    
    @media (max-width: 768px) {
      .filter-section {
        flex-direction: column;
        align-items: stretch;
        gap: 10px;
      }
      
      .filter-select, .filter-input {
        width: 100%;
        min-width: auto;
      }
    }
    
    /* Button styling to match CivicServe design */
    .btn-primary {
      background-color: rgb(var(--c-primary));
      border-color: rgb(var(--c-primary));
      color: white;
      font-weight: 500;
      border-radius: 4px;
      transition: all 0.15s ease-in-out;
    }
    
    .btn-primary:hover {
      background-color: var(--c-landing-light20-primary-color);
      border-color: var(--c-landing-light20-primary-color);
      color: white;
    }
    
    .btn-primary:focus {
      background-color: var(--c-landing-light20-primary-color);
      border-color: var(--c-landing-light20-primary-color);
      box-shadow: 0 0 0 0.2rem rgba(var(--c-primary), 0.25);
      color: white;
    }
    
    .btn-primary:disabled {
      background-color: rgb(var(--c-primary));
      border-color: rgb(var(--c-primary));
      opacity: 0.65;
    }
    
    /* Page header styling */
    .page-header {
      display: flex;
      justify-content: space-between;
      margin: 15px 0;
      gap: 15px;
      flex-wrap: wrap;
    }
    
    .page-header-left {
      display: flex;
      align-self: center;
      gap: 15px;
      flex-grow: 1;
      word-break: break-word;
    }
    
    .heading-3 {
      font-size: 1.5rem;
      margin-bottom: 0;
      font-weight: normal;
      color: var(--c-font-primary);
      display: flex;
      gap: 10px;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div id="root">
    <div class="container-fluid p-0 dx-viewport" data-theme="light">
      <div id="loader" class="linear-activity" style="display: none;">
        <div class="indeterminate"></div>
      </div>
      <div class="header-content-wrapper">
        <div>
          <div class="header-wrapper">
            <div class="align-self-center header-left-wrapper">
              <button class="btn side-nav-toggle-btn px-0">
                <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                  <path fill="currentColor" d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path>
                </svg>
              </button>
              <a href="#"><img src="https://dmitri.github.io/projects/civicserve/cs-dashboard/src/cs-logo-white.png"></a>
            </div>
            <form class="search-wrapper">
              <div class="search-input">
                <div class="search-icon">
                  <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="magnifying-glass" class="svg-inline--fa fa-magnifying-glass " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                    <path fill="currentColor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path>
                  </svg>
                </div>
                <input type="text" class="form-control" placeholder="Search Programs, Projects, or Contacts">
              </div>
              <div class="select-dropdown">
                <select class="form-select">
                  <option>All</option>
                  <option>Programs</option>
                  <option>Projects</option>
                  <option>Contacts</option>
                </select>
              </div>
            </form>
            <div class="header-right align-self-center">
              <div class="header-support-wrapper">
                <button class="btn btn-link">
                  <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="circle-question" class="svg-inline--fa fa-circle-question " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                    <path fill="currentColor" d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path>
                  </svg>
                </button>
              </div>
              <div class="d-flex">
                <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="list-check" class="svg-inline--fa fa-list-check " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                  <path fill="currentColor" d="M153.8 72.1c8.9-9.9 8.1-25-1.8-33.9s-25-8.1-33.9 1.8L63.1 101.1 41 79C31.6 69.7 16.4 69.7 7 79s-9.4 24.6 0 33.9l40 40c4.7 4.7 11 7.2 17.6 7s12.8-3 17.2-7.9l72-80zm0 160c8.9-9.9 8.1-25-1.8-33.9s-25-8.1-33.9 1.8L63.1 261.1 41 239c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l40 40c4.7 4.7 11 7.2 17.6 7s12.8-3 17.2-7.9l72-80zM216 120H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H216c-13.3 0-24 10.7-24 24s10.7 24 24 24zM192 256c0 13.3 10.7 24 24 24H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H216c-13.3 0-24 10.7-24 24zM160 416c0 13.3 10.7 24 24 24H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H184c-13.3 0-24 10.7-24 24zm-64 0a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path>
                </svg>
              </div>
              <div class="user-details-wrapper">
                <div class="user-details-container d-flex align-items-center">
                  <div class="name-initial-container">
                    <div id="name">GG</div>
                  </div>
                  <div class="user-details">
                    <div class="user-name">Gary Gov</div>
                    <div class="user-role">Admin</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="content-wrapper">
        <div class="overlay-effect"></div>
        <!-- Side Navigation -->
        <nav class="side-nav">
          <ul class="side-nav-list">
            <li>
              <a class="menu-item">
                <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="chart-bar" class="svg-inline--fa fa-chart-bar menu-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                  <path fill="currentColor" d="M24 32c13.3 0 24 10.7 24 24V456c0 13.3 10.7 24 24 24H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H72c-39.8 0-72-32.2-72-72V56C0 42.7 10.7 32 24 32zM128 136c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V136zm96-88c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V48zM320 200c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V200zm96-88c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V112z"></path>
                </svg>
                <div class="menu-label">Data</div>
                <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                  <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                </svg>
              </a>
              <ul class="sub-menu sub-menu-show">
                <li>
                  <a class="menu-item">
                    <div class="menu-label">Tools</div>
                    <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a class="menu-item">
                    <div class="menu-label">Reports</div>
                    <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a class="menu-item">
                    <div class="menu-label">Application Integrations</div>
                    <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                    </svg>
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </nav>
        
        <!-- Main Content -->
        <div class="container-fluid">
          <div class="row">
            <div class="col-12">
              <!-- Page Header -->
              <div class="page-header">
                <div class="page-header-left">
                  <h3 class="heading-3">Business Finder</h3>
                </div>
              </div>
              <div id="business-finder-app"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="text/babel">
    function BusinessFinderApp() {
      // State variables for managing the search input, selected city, business data, loading status, and errors
      const [searchTerm, setSearchTerm] = React.useState('');
      const [selectedCity, setSelectedCity] = React.useState(null);
      const [businesses, setBusinesses] = React.useState([]);
      const [totalBusinesses, setTotalBusinesses] = React.useState(0);
      const [loading, setLoading] = React.useState(false);
      const [error, setError] = React.useState('');
      // State for "Select All" checkbox and the count of selected businesses
      const [isAllSelected, setIsAllSelected] = React.useState(false);
      const [selectedCount, setSelectedCount] = React.useState(0);

      // States for filter ranges - these are no longer cleared on new search
      const [minExpandability, setMinExpandability] = React.useState('');
      const [maxExpandability, setMaxExpandability] = React.useState('');
      const [minEmployees, setMinEmployees] = React.useState('');
      const [maxEmployees, setMaxEmployees] = React.useState('');
      const [minRevenue, setMinRevenue] = React.useState('');
      const [maxRevenue, setMaxRevenue] = React.useState('');

      // New states for the new filters
      const [selectedIndustry, setSelectedIndustry] = React.useState('');
      const [selectedProgram, setSelectedProgram] = React.useState('');
      
      // States for applied filters - these are only updated when the Search button is clicked
      const [appliedMinExpandability, setAppliedMinExpandability] = React.useState('');
      const [appliedMaxExpandability, setAppliedMaxExpandability] = React.useState('');
      const [appliedMinEmployees, setAppliedMinEmployees] = React.useState('');
      const [appliedMaxEmployees, setAppliedMaxEmployees] = React.useState('');
      const [appliedMinRevenue, setAppliedMinRevenue] = React.useState('');
      const [appliedMaxRevenue, setAppliedMaxRevenue] = React.useState('');
      const [appliedIndustry, setAppliedIndustry] = React.useState('');
      const [appliedProgram, setAppliedProgram] = React.useState('');

      // State for custom alert message
      const [showAlert, setShowAlert] = React.useState(false);
      const [alertMessage, setAlertMessage] = React.useState('');

      // Mock city data for demonstration purposes
      const citiesData = [
        { name: 'Pawnee', state: 'Indiana' },
        { name: 'Scranton', state: 'Pennsylvania' },
      ];

      // New mock data for industries (NAICS codes)
      const naicsCodes = [
        { code: '511', description: 'Publishing Industries' },
        { code: '541', description: 'Professional, Scientific, and Technical Services' },
        { code: '621', description: 'Ambulatory Health Care Services' },
        { code: '711', description: 'Performing Arts, Spectator Sports' },
        { code: '722', description: 'Food Services and Drinking Places' },
        { code: '561', description: 'Administrative and Support Services' },
      ];

      // New mock data for economic development programs
      const programs = ['Grant', 'TIF', 'OppZone', 'Loans'];

      // A list of fake business names based on American sitcoms
      const fakeBusinessNames = [
        'Pawnee Parks & Recreation',
        'Ron Swanson\'s Fine Woodworking',
        'JJ\'s Diner',
        'Sweetums',
        'The Office of Parks & Recreation',
        'The Pit',
        'Gryzzl',
        'The Paper Company',
        'Dunder Mifflin',
        'Vance Refrigeration',
        'Schrute Farms',
        'Michael Scott Paper Company',
        'Saticoy Steel',
        'O\'Malley\'s Office Supplies',
        'Scranton Business Park',
        'AARM, Inc.',
        'Sabre',
        'Wernham Hogg',
        'The Golden Girls Retirement Home',
        'Cheers',
        'Central Perk',
        'Monk\'s Cafe',
        'Kwik-E-Mart',
        'The Bluth Company',
      ];

      /**
       * Mock function to simulate generating business data based on a city.
       * @param {string} cityName - The name of the city to generate businesses for.
       * @returns {{mockBusinesses: Array, mockTotal: number}} An object containing an array of mock businesses and the total count.
       */
      const generateBusinesses = (cityName) => {
        const mockTotal = Math.floor(Math.random() * 20000) + 500;
        const mockBusinesses = Array.from({ length: 100 }).map((_, i) => ({
          name: `${fakeBusinessNames[i % fakeBusinessNames.length]} (${cityName} branch)`,
          city: cityName,
          employees: Math.floor(Math.random() * 5000) + 10,
          revenue: (Math.random() * 100000000).toFixed(2),
          expandabilityScore: Math.floor(Math.random() * 101),
          // Assign random NAICS code and programs to each business
          industry: naicsCodes[Math.floor(Math.random() * naicsCodes.length)],
          programs: programs.filter(() => Math.random() > 0.5),
          isSelected: false,
        }));
        return { mockBusinesses, mockTotal };
      };

      /**
       * Handles the search logic when the user submits a query.
       */
      const handleSearch = async () => {
        setLoading(true);
        setError('');
        setBusinesses([]);
        setTotalBusinesses(0);
        setSelectedCity(null);
        setIsAllSelected(false);
        setSelectedCount(0);
        setShowAlert(false);

        // Update the applied filter states with the current input values
        setAppliedMinExpandability(minExpandability);
        setAppliedMaxExpandability(maxExpandability);
        setAppliedMinEmployees(minEmployees);
        setAppliedMaxEmployees(maxEmployees);
        setAppliedMinRevenue(minRevenue);
        setAppliedMaxRevenue(maxRevenue);
        setAppliedIndustry(selectedIndustry);
        setAppliedProgram(selectedProgram);

        await new Promise(resolve => setTimeout(resolve, 1000));

        const foundCity = citiesData.find(
          (item) => item.name.toLowerCase() === searchTerm.toLowerCase()
        );

        if (foundCity) {
          setSelectedCity(foundCity.name);
          const { mockBusinesses, mockTotal } = generateBusinesses(foundCity.name);
          const sortedBusinesses = mockBusinesses.sort((a, b) => b.expandabilityScore - a.expandabilityScore);
          setBusinesses(sortedBusinesses);
          setTotalBusinesses(mockTotal);
        } else {
          setError('No city found for your search term. Try "Pawnee" or "Scranton".');
        }
        setLoading(false);
      };

      /**
       * Toggles the selection state of all businesses.
       */
      const handleSelectAll = () => {
        const newSelectAll = !isAllSelected;
        setIsAllSelected(newSelectAll);
        const updatedBusinesses = businesses.map(business => {
          const isFiltered = filteredBusinesses.includes(business);
          return {
            ...business,
            isSelected: isFiltered ? newSelectAll : business.isSelected,
          };
        });
        setBusinesses(updatedBusinesses);
        setSelectedCount(newSelectAll ? filteredBusinesses.length : 0);
      };

      /**
       * Toggles the selection state of a single business.
       */
      const handleRowSelect = (index) => {
        const businessToToggle = filteredBusinesses[index];
        const originalIndex = businesses.findIndex(b => b.name === businessToToggle.name && b.city === businessToToggle.city);

        if (originalIndex !== -1) {
          const updatedBusinesses = [...businesses];
          updatedBusinesses[originalIndex].isSelected = !updatedBusinesses[originalIndex].isSelected;
          setBusinesses(updatedBusinesses);
          const newSelectedCount = updatedBusinesses.filter(b => b.isSelected).length;
          setSelectedCount(newSelectedCount);
          setIsAllSelected(newSelectedCount === filteredBusinesses.length && filteredBusinesses.length > 0);
        }
      };

      /**
       * Simulates saving selected businesses to a CRM.
       */
      const handleSaveToCRM = () => {
        const selectedBusinesses = businesses.filter(business => business.isSelected);
        if (selectedBusinesses.length > 0) {
          console.log('Saving the following businesses to CRM:', selectedBusinesses);
          setAlertMessage(`Successfully simulated saving ${selectedBusinesses.length} business(es) to CRM! Check console for details.`);
          setShowAlert(true);
        } else {
          setAlertMessage('Please select at least one business to save to CRM.');
          setShowAlert(true);
        }
      };

      /**
       * Filters the businesses based on the current filter ranges.
       */
      const filteredBusinesses = businesses.filter(business => {
        const expandability = business.expandabilityScore;
        if (appliedMinExpandability !== '' && expandability < parseFloat(appliedMinExpandability)) return false;
        if (appliedMaxExpandability !== '' && expandability > parseFloat(appliedMaxExpandability)) return false;

        const employees = business.employees;
        if (appliedMinEmployees !== '' && employees < parseFloat(appliedMinEmployees)) return false;
        if (appliedMaxEmployees !== '' && employees > parseFloat(appliedMaxEmployees)) return false;

        const revenue = parseFloat(business.revenue);
        if (appliedMinRevenue !== '' && revenue < parseFloat(appliedMinRevenue)) return false;
        if (appliedMaxRevenue !== '' && revenue > parseFloat(appliedMaxRevenue)) return false;

        // Apply new filters
        if (appliedIndustry && business.industry.code !== appliedIndustry) return false;
        if (appliedProgram && !business.programs.includes(appliedProgram)) return false;

        return true;
      });

      React.useEffect(() => {
        if (filteredBusinesses.length > 0) {
          const allFilteredSelected = filteredBusinesses.every(business => business.isSelected);
          setIsAllSelected(allFilteredSelected);
        } else {
          setIsAllSelected(false);
        }
        setSelectedCount(businesses.filter(b => b.isSelected).length);
      }, [filteredBusinesses, businesses]);

      // Custom Alert Message Component
      const AlertMessage = ({ message, onClose }) => {
        if (!message) return null;
        return (
          <div className="fixed top-4 left-1/2 transform -translate-x-1/2 bg-blue-500 text-white px-6 py-3 rounded-md shadow-lg flex items-center justify-between z-50 animate-fade-in-down">
            <span>{message}</span>
            <button onClick={onClose} className="ml-4 text-white hover:text-gray-200">
              &times;
            </button>
          </div>
        );
      };

      return (
        <div className="row">
          <div className="col-12">
            <div style={{padding: '20px'}}>
            {/* Custom Alert */}
            {showAlert && <AlertMessage message={alertMessage} onClose={() => setShowAlert(false)} />}

            {/* Application Title - now handled by page header above */}

            {/* Search and Filter Container */}
            <div className="mb-6 w-full p-4 bg-white rounded-lg shadow-sm border border-gray-200">
              {/* Search Input Section */}
              <div className="mb-4 w-full relative">
                {searchTerm === '' && (
                  <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                  </div>
                )}
                <input
                  type="text"
                  className="w-full p-3 rounded-lg search-input-mockup transition duration-200"
                  placeholder="Search by City (e.g., 'Pawnee' or 'Scranton')"
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                />
              </div>
              
              {/* Filters Section */}
              <div className="filter-section">
                {/* Expandability Score Filter */}
                <div className="mb-2">
                  <label className="filter-label">Expandability Score</label>
                  <div style={{display: 'flex', gap: '8px'}}>
                    <input
                      type="number"
                      placeholder="Min"
                      value={minExpandability}
                      onChange={(e) => setMinExpandability(e.target.value)}
                      className="filter-input"
                      min="0"
                      max="100"
                    />
                    <input
                      type="number"
                      placeholder="Max"
                      value={maxExpandability}
                      onChange={(e) => setMaxExpandability(e.target.value)}
                      className="filter-input"
                      min="0"
                      max="100"
                    />
                  </div>
                </div>

                {/* Employees Filter */}
                <div className="mb-2">
                  <label className="filter-label">Number of Employees</label>
                  <div style={{display: 'flex', gap: '8px'}}>
                    <input
                      type="number"
                      placeholder="Min"
                      value={minEmployees}
                      onChange={(e) => setMinEmployees(e.target.value)}
                      className="filter-input"
                      min="0"
                    />
                    <input
                      type="number"
                      placeholder="Max"
                      value={maxEmployees}
                      onChange={(e) => setMaxEmployees(e.target.value)}
                      className="filter-input"
                      min="0"
                    />
                  </div>
                </div>

                {/* Total Revenue Filter */}
                <div className="mb-2">
                  <label className="filter-label">Total Revenue ($)</label>
                  <div style={{display: 'flex', gap: '8px'}}>
                    <input
                      type="number"
                      placeholder="Min"
                      value={minRevenue}
                      onChange={(e) => setMinRevenue(e.target.value)}
                      className="filter-input"
                      min="0"
                    />
                    <input
                      type="number"
                      placeholder="Max"
                      value={maxRevenue}
                      onChange={(e) => setMaxRevenue(e.target.value)}
                      className="filter-input"
                      min="0"
                    />
                  </div>
                </div>

                {/* Industry Filter */}
                <div className="mb-2">
                  <label htmlFor="industry-select" className="filter-label">Industry (NAICS)</label>
                  <select
                    id="industry-select"
                    value={selectedIndustry}
                    onChange={(e) => setSelectedIndustry(e.target.value)}
                    className="filter-select"
                  >
                    <option value="">All</option>
                    {naicsCodes.map(naics => (
                      <option key={naics.code} value={naics.code}>
                        {naics.code} - {naics.description}
                      </option>
                    ))}
                  </select>
                </div>

                {/* Economic Development Programs Filter */}
                <div className="mb-2">
                  <label htmlFor="program-select" className="filter-label">Economic Dev. Program</label>
                  <select
                    id="program-select"
                    value={selectedProgram}
                    onChange={(e) => setSelectedProgram(e.target.value)}
                    className="filter-select"
                  >
                    <option value="">All</option>
                    {programs.map(program => (
                      <option key={program} value={program}>
                        {program}
                      </option>
                    ))}
                  </select>
                </div>
              </div>
              
              {/* Search button for filters */}
              <div className="mt-4 d-flex justify-content-end">
                <button
                  onClick={handleSearch}
                  className="btn btn-primary px-4 py-2"
                  disabled={loading} // Disable button when loading
                >
                  {loading ? (
                    // Loading spinner SVG
                    <svg className="animate-spin h-5 w-5 text-white inline-block mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                      <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                      <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                  ) : (
                    'Search'
                  )}
                </button>
              </div>
            </div>

            {/* Error Message Display */}
            {error && (
              <div className="w-full bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6 relative" role="alert">
                <strong className="font-bold">Error:</strong>
                <span className="block sm:inline ml-2">{error}</span>
              </div>
            )}

            {/* Loading Indicator */}
            {loading && (
              <div className="flex justify-center items-center py-10">
                <svg className="animate-spin h-10 w-10 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                  <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <span className="ml-3 text-gray-600">Loading businesses...</span>
              </div>
            )}

            {/* Business List Display */}
            {businesses.length > 0 && (
              <div className="w-full mt-8">
                <div className="flex justify-between items-center mb-4">
                  <div>
                    <h2 className="text-2xl font-semibold text-gray-700">
                      Businesses in: <span className="text-blue-600">{selectedCity}</span>
                    </h2>
                    <p className="text-sm text-gray-600">
                      Showing <span className="font-semibold">{filteredBusinesses.length}</span> of <span className="font-semibold">{totalBusinesses.toLocaleString()}</span> businesses
                    </p>
                  </div>
                  <button
                    onClick={handleSaveToCRM}
                    className="button-primary py-2 px-4 text-sm disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled={selectedCount === 0}
                  >
                    Save {selectedCount} Business{selectedCount !== 1 ? 'es' : ''} to CRM
                  </button>
                </div>

                {/* Business List Table */}
                <div className="overflow-hidden rounded-lg table-container">
                  <table className="min-w-full divide-y divide-gray-200">
                    <thead className="table-header">
                      <tr>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          <input
                            type="checkbox"
                            className="form-checkbox h-4 w-4 text-blue-600 rounded"
                            checked={isAllSelected && filteredBusinesses.length > 0}
                            onChange={handleSelectAll}
                            disabled={filteredBusinesses.length === 0}
                          />
                        </th>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Business Name</th>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">City</th>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Expandability Score</th>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"># of Employees</th>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Revenue</th>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NAICS Code</th>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NAICS Description</th>
                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Programs</th>
                      </tr>
                    </thead>
                    <tbody className="bg-white divide-y divide-gray-200">
                      {filteredBusinesses.length > 0 ? (
                        filteredBusinesses.map((business, index) => (
                          <tr key={index} className="table-row-hover">
                            <td className="px-6 py-4 whitespace-nowrap text-sm">
                              <input
                                type="checkbox"
                                className="form-checkbox h-4 w-4 text-blue-600 rounded"
                                checked={business.isSelected}
                                onChange={() => handleRowSelect(index)}
                              />
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{business.name}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{business.city}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm font-semibold">
                              <span
                                className={`inline-flex px-2 py-1 rounded-full text-xs font-medium ${
                                  business.expandabilityScore > 75
                                    ? 'bg-green-100 text-green-800'
                                    : business.expandabilityScore > 50
                                    ? 'bg-yellow-100 text-yellow-800'
                                    : 'bg-red-100 text-red-800'
                                }`}
                              >
                                {business.expandabilityScore}
                              </span>
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{business.employees.toLocaleString()}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${parseFloat(business.revenue).toLocaleString()}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{business.industry.code}</td>
                            <td className="px-6 py-4 text-sm text-gray-600">{business.industry.description}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{business.programs.join(', ')}</td>
                          </tr>
                        ))
                      ) : (
                        <tr>
                          <td colSpan="9" className="px-6 py-4 text-center text-gray-500">
                            No businesses found matching your filter criteria.
                          </td>
                        </tr>
                      )}
                    </tbody>
                  </table>
                </div>
              </div>
            )}
            </div>
          </div>
        </div>
      );
    }

    const container = document.getElementById('business-finder-app');
    const root = ReactDOM.createRoot(container);
    root.render(<BusinessFinderApp />);
  </script>
  
  <script>
    // Side navigation toggle functionality
    document.addEventListener('DOMContentLoaded', function() {
      // Hide loading indicator when page is loaded
      setTimeout(function() {
        document.getElementById('loader').style.display = 'none';
      }, 500);
      
      // Side navigation toggle
      const sideNavToggleBtn = document.querySelector('.side-nav-toggle-btn');
      const contentWrapper = document.querySelector('.content-wrapper');
      const sideNav = document.querySelector('.side-nav');
      const overlayEffect = document.querySelector('.overlay-effect');
      
      if (sideNavToggleBtn) {
        sideNavToggleBtn.addEventListener('click', function() {
          if (sideNav.style.transform === 'translateX(-100%)') {
            // Show side nav
            sideNav.style.transform = 'translateX(0)';
            overlayEffect.style.display = 'block';
            contentWrapper.classList.remove('no-nav');
          } else {
            // Hide side nav
            sideNav.style.transform = 'translateX(-100%)';
            overlayEffect.style.display = 'none';
            contentWrapper.classList.add('no-nav');
          }
        });
      }
      
      // Close side nav when clicking overlay
      if (overlayEffect) {
        overlayEffect.addEventListener('click', function() {
          sideNav.style.transform = 'translateX(-100%)';
          overlayEffect.style.display = 'none';
          contentWrapper.classList.add('no-nav');
        });
      }
      
      // Toggle sub-menus
      const menuItems = document.querySelectorAll('.menu-item');
      menuItems.forEach(item => {
        const subMenu = item.nextElementSibling;
        if (subMenu && subMenu.classList.contains('sub-menu')) {
          item.addEventListener('click', function(e) {
            // Don't toggle if clicking on a link
            if (e.target.tagName === 'A') return;
            
            subMenu.classList.toggle('sub-menu-show');
            const actionIcon = item.querySelector('.action-icon');
            if (actionIcon) {
              actionIcon.style.transform = subMenu.classList.contains('sub-menu-show') ? 'rotate(180deg)' : 'rotate(0)';
            }
          });
        }
      });
      
      // Initialize side nav state (hidden on mobile, visible on desktop)
      if (window.innerWidth < 992) {
        sideNav.style.transform = 'translateX(-100%)';
        contentWrapper.classList.add('no-nav');
      } else {
        sideNav.style.transform = 'translateX(0)';
        contentWrapper.classList.remove('no-nav');
      }
      
      // Initialize submenu state (expand active menu)
      document.querySelectorAll('.menu-item.active').forEach(item => {
        const parentLi = item.closest('li');
        if (parentLi && parentLi.parentElement.classList.contains('sub-menu')) {
          const parentMenu = parentLi.parentElement.previousElementSibling;
          if (parentMenu && parentMenu.classList.contains('menu-item')) {
            const subMenu = parentMenu.nextElementSibling;
            if (subMenu) {
              subMenu.classList.add('sub-menu-show');
            }
          }
        }
      });
      
      // Handle window resize
      window.addEventListener('resize', function() {
        if (window.innerWidth < 992) {
          sideNav.style.transform = 'translateX(-100%)';
          contentWrapper.classList.add('no-nav');
          overlayEffect.style.display = 'none';
        } else {
          sideNav.style.transform = '';
          contentWrapper.classList.remove('no-nav');
        }
      });
    });
  </script>
</body>
</html>
