<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Information Request Mockup V2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --c-primary: 0, 55, 96; /* Blue color in RGB matching header #003760 */
            --c-landing-primary: 0, 55, 96;
            --c-landing-light20-primary-color: #1a4a7a;
            --c-landing-light30-primary-color: #2d5d8d;
            --c-landing-light35-primary-color: #3a6a9a;
            --c-landing-light40-primary-color: #4777a7;
            --c-landing-darken10-primary-color: #002040;
            --c-landing-secondary: #ffa800;
            --c-primary-contrast: #003760;
            --c-font-primary: #333333;
            --c-font-secondary: #6b7280;
            --c-card-background: #ffffff;
            --c-background: #f8f9fa;
            --c-success: #9CB1C1;
            --c-danger: #F44336;
            --c-warning: #f0ad4e;
            --dim-header-height: 60px;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f8fa; /* Lighter, cleaner background */
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }
        
        /* Header styles */
        .header-content-wrapper {
            background-color: #003760;
            color: white;
            height: var(--dim-header-height);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
        }
        
        .header-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 1rem;
            height: 100%;
        }
        
        .header-left-wrapper {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .header-left-wrapper img {
            height: 30px;
        }
        
        .header-right svg, .header-left-wrapper svg {
            width: 20px;
            height: 20px;
            color: white;
            cursor: pointer;
        }
        
        .header-right .btn-link {
            color: white;
        }
        
        .header-right .btn-link:hover, .side-nav-toggle-btn:hover {
            opacity: 0.8;
        }
        
        /* Side Navigation Styles */
        .side-nav {
            position: fixed;
            top: var(--dim-header-height);
            left: 0;
            width: 240px;
            height: calc(100vh - var(--dim-header-height));
            background-color: white;
            color: #333;
            z-index: 1000;
            overflow-y: auto;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }
        
        .content-wrapper {
            margin-left: 240px;
            margin-top: var(--dim-header-height);
            transition: margin-left 0.3s ease;
            min-height: calc(100vh - var(--dim-header-height));
            background-color: var(--c-background);
        }
        
        .content-wrapper.no-nav {
            margin-left: 0;
        }
        
        /* Search styling */
        .search-wrapper {
            display: flex;
            flex-grow: 1;
            max-width: 600px;
            margin: 0 20px;
            height: 40px;
            align-items: center;
        }
        
        .search-input {
            position: relative;
            flex-grow: 1;
            height: 100%;
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            z-index: 2;
            width: 16px;
            height: 16px;
        }
        
        .search-input input {
            width: 100%;
            height: 100%;
            padding: 8px 12px 8px 40px;
            background-color: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 6px 0 0 6px;
            font-size: 14px;
            outline: none;
            transition: background-color 0.2s ease;
        }
        
        .search-input input:focus {
            background-color: white;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
        }
        
        .search-input input::placeholder {
            color: #6b7280;
        }
        
        .select-dropdown {
            height: 100%;
            min-width: 80px;
        }
        
        .select-dropdown select {
            width: 100%;
            height: 100%;
            padding: 8px 12px;
            border: none;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 0 6px 6px 0;
            font-size: 14px;
            outline: none;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .select-dropdown select:focus {
            background-color: white;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
        }
        
        /* User details styling */
        .user-details-wrapper {
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }
        
        .user-details-wrapper:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .name-initial-container {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #9CB1C1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .user-details {
            margin-left: 10px;
        }
        
        .user-name {
            font-weight: bold;
            font-size: 0.9rem;
            line-height: 1.2;
        }
        
        .user-role {
            font-size: 0.75rem;
            opacity: 0.8;
            line-height: 1.2;
        }
        
        /* Side Navigation Styles */
        .side-nav-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .side-nav-list li {
            position: relative;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            color: #333;
            text-decoration: none;
            transition: background-color 0.2s ease;
            cursor: pointer;
            border-left: 4px solid transparent;
            font-size: 13px;
            line-height: 1.4;
        }
        
        .menu-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .menu-item.active {
            background-color: #003760;
            color: white;
            border-left: 4px solid #003760;
            font-weight: 500;
        }
        
        .sub-menu .menu-item.active {
            background-color: #003760;
            color: white;
            border-left: 4px solid #003760;
            padding-left: 45px;
            font-weight: 500;
        }
        
        .sub-menu .menu-item {
            padding-left: 45px;
            padding-top: 8px;
            padding-bottom: 8px;
            font-size: 12px;
        }
        
        .menu-icon {
            margin-right: 12px;
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }
        
        .menu-label {
            flex-grow: 1;
        }
        
        .action-icon {
            transition: transform 0.2s ease;
            width: 12px !important;
            height: 12px !important;
            margin-left: auto;
        }
        
        .sub-menu {
            list-style: none;
            padding-left: 0;
            margin: 0;
            display: none;
            background-color: rgba(0, 0, 0, 0.02);
        }
        
        .sub-menu-show {
            display: block;
        }
        
        .side-nav-toggle-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 8px;
            margin-right: 5px;
        }
        
        .side-nav-toggle-btn svg {
            width: 24px;
            height: 24px;
        }
        
        .overlay-effect {
            display: none;
            position: fixed;
            top: var(--dim-header-height);
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        
        /* Page header styling */
        .page-header {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .page-header-left {
            display: flex;
            align-self: center;
            gap: 15px;
            flex-grow: 1;
            word-break: break-word;
        }
        
        .heading-3 {
            font-size: 1.5rem;
            margin-bottom: 0;
            font-weight: normal;
            color: var(--c-font-primary);
            display: flex;
            gap: 10px;
        }
        
        /* Form controls - excluding search elements */
        .form-control:not(.search-input input), .form-select:not(.select-dropdown select) {
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.875rem;
            color: var(--c-font-primary);
            transition: all 0.15s ease-in-out;
        }
        
        .form-control:not(.search-input input):focus, .form-select:not(.select-dropdown select):focus {
            border-color: rgb(var(--c-primary));
            box-shadow: 0 0 0 2px rgba(var(--c-primary), 0.2);
        }
        
        /* Bootstrap-like utility classes */
        .container-fluid {
            width: 100%;
            padding-right: 15px;
            padding-left: 15px;
            margin-right: auto;
            margin-left: auto;
        }
        
        .row {
            display: flex;
            flex-wrap: wrap;
            margin-right: -15px;
            margin-left: -15px;
        }
        
        .col-12 {
            flex: 0 0 100%;
            max-width: 100%;
            position: relative;
            width: 100%;
            padding-right: 15px;
            padding-left: 15px;
        }
        
        .d-flex {
            display: flex !important;
        }
        
        .align-items-center {
            align-items: center !important;
        }
        
        .align-self-center {
            align-self: center !important;
        }
        
        .btn {
            display: inline-block;
            font-weight: 400;
            color: #212529;
            text-align: center;
            vertical-align: middle;
            cursor: pointer;
            background-color: transparent;
            border: 1px solid transparent;
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            border-radius: 0.25rem;
            transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        
        .btn-link {
            font-weight: 400;
            color: #0d6efd;
            text-decoration: underline;
        }
        
        .btn-link:hover {
            color: #0a58ca;
        }
        
        .px-0 {
            padding-left: 0 !important;
            padding-right: 0 !important;
        }
        
        /* CivicServe Blue Button Styling */
        .btn-civicserve {
            background-color: #003760 !important;
        }
        
        .btn-civicserve:hover {
            background-color: #1a4a7a !important;
        }
        
        .btn-civicserve:focus {
            box-shadow: 0 0 0 2px rgba(0, 55, 96, 0.3) !important;
        }
        
        .bg-civicserve {
            background-color: #003760 !important;
        }
        
        .bg-civicserve:hover {
            background-color: #1a4a7a !important;
        }
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(17, 24, 39, 0.6); /* Darker backdrop for more focus */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .modal-backdrop.active {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background: white;
            border-radius: 0.75rem; /* Slightly larger radius */
            padding: 2rem;
            width: 90%;
            max-width: 56rem; /* 896px */
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .modal-backdrop.active .modal-content {
            transform: scale(1);
        }
        .tab-button.active {
            border-bottom-color: #003760;
            color: #003760;
            font-weight: 600;
        }
        .tab-button {
             border-bottom: 2px solid transparent;
        }
        .step-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 9999px;
            font-weight: 600;
            border: 2px solid transparent;
        }
        .step-indicator.active {
            background-color: rgba(0, 55, 96, 0.1);
            color: #003760;
            border-color: #003760;
        }
        .step-indicator.complete {
            background-color: #16a34a;
            color: white;
        }
        .step-indicator.inactive {
            background-color: #e5e7eb;
            color: #6b7280;
        }
        .step-line {
            height: 2px;
            flex-grow: 1;
            background-color: #e5e7eb;
        }
        .step-line.complete {
           background-color: #16a34a;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div id="root">
        <div class="container-fluid p-0 dx-viewport" data-theme="light">
            <div class="header-content-wrapper">
                <div>
                    <div class="header-wrapper">
                        <div class="align-self-center header-left-wrapper">
                            <button class="btn side-nav-toggle-btn px-0">
                                <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                    <path fill="currentColor" d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path>
                                </svg>
                            </button>
                            <a href="#"><img src="https://dmitri.github.io/projects/civicserve/cs-dashboard/src/cs-logo-white.png"></a>
                        </div>
                        <form class="search-wrapper">
                            <div class="search-input">
                                <div class="search-icon">
                                    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="magnifying-glass" class="svg-inline--fa fa-magnifying-glass " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                        <path fill="currentColor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path>
                                    </svg>
                                </div>
                                <input type="text" class="form-control" placeholder="Search Programs, Projects, or Contacts">
                            </div>
                            <div class="select-dropdown">
                                <select class="form-select">
                                    <option>All</option>
                                    <option>Programs</option>
                                    <option>Projects</option>
                                    <option>Contacts</option>
                                </select>
                            </div>
                        </form>
                        <div class="header-right align-self-center">
                            <div class="header-support-wrapper">
                                <button class="btn btn-link">
                                    <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="circle-question" class="svg-inline--fa fa-circle-question " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                        <path fill="currentColor" d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="d-flex">
                                <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="list-check" class="svg-inline--fa fa-list-check " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                    <path fill="currentColor" d="M153.8 72.1c8.9-9.9 8.1-25-1.8-33.9s-25-8.1-33.9 1.8L63.1 101.1 41 79C31.6 69.7 16.4 69.7 7 79s-9.4 24.6 0 33.9l40 40c4.7 4.7 11 7.2 17.6 7s12.8-3 17.2-7.9l72-80zm0 160c8.9-9.9 8.1-25-1.8-33.9s-25-8.1-33.9 1.8L63.1 261.1 41 239c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l40 40c4.7 4.7 11 7.2 17.6 7s12.8-3 17.2-7.9l72-80zM216 120H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H216c-13.3 0-24 10.7-24 24s10.7 24 24 24zM192 256c0 13.3 10.7 24 24 24H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H216c-13.3 0-24 10.7-24 24zM160 416c0 13.3 10.7 24 24 24H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H184c-13.3 0-24 10.7-24 24zm-64 0a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path>
                                </svg>
                            </div>
                            <div class="user-details-wrapper">
                                <div class="user-details-container d-flex align-items-center">
                                    <div class="name-initial-container">
                                        <div id="name">GG</div>
                                    </div>
                                    <div class="user-details">
                                        <div class="user-name">Gary Gov</div>
                                        <div class="user-role">Admin</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-wrapper">
                <div class="overlay-effect"></div>
                <!-- Side Navigation -->
                <nav class="side-nav">
                    <ul class="side-nav-list">
                      <li>
                        <a class="menu-item">
                          <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="chart-bar" class="svg-inline--fa fa-chart-bar menu-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path fill="currentColor" d="M24 32c13.3 0 24 10.7 24 24V456c0 13.3 10.7 24 24 24H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H72c-39.8 0-72-32.2-72-72V56C0 42.7 10.7 32 24 32zM128 136c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V136zm96-88c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V48zM320 200c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V200zm96-88c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V112z"></path>
                          </svg>
                          <div class="menu-label">Data</div>
                          <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                          </svg>
                        </a>
                        <ul class="sub-menu sub-menu-show">
                          <li>
                            <a class="menu-item">
                              <div class="menu-label">Tools</div>
                              <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                              </svg>
                            </a>
                          </li>
                          <li>
                            <a class="menu-item">
                              <div class="menu-label">Reports</div>
                              <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                              </svg>
                            </a>
                          </li>
                          <li>
                            <a class="menu-item">
                              <div class="menu-label">Application Integrations</div>
                              <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                              </svg>
                            </a>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </nav>
                
                <!-- Main Content -->
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12">
                            <!-- Page Header -->
                            <div class="page-header">
                                <div class="page-header-left">
                                    <h3 class="heading-3">Data Request Hub</h3>
                                </div>
                            </div>
                            
                            <!-- Main Container -->
                            <div id="main-content" class="space-y-8">

        <!-- Tab Navigation -->
        <div class="border-b border-gray-200">
            <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                <button onclick="showTab('hub')" class="tab-button active whitespace-nowrap py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700">Data Requests</button>
                <button onclick="showTab('contextual')" class="tab-button whitespace-nowrap py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700">Request Information</button>
                <button onclick="showTab('external')" class="tab-button whitespace-nowrap py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700">External Recipient View</button>
            </nav>
        </div>

        <!-- Information Request Hub -->
        <div id="hub-view">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                <!-- Header -->
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                    <h1 class="text-2xl font-bold text-gray-900">Information Requests</h1>
                    <button onclick="openModal('createRequestModal')" class="mt-4 md:mt-0 flex items-center justify-center bg-civicserve text-white font-semibold py-2 px-4 rounded-lg shadow-sm transition duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2">
                        <i data-lucide="plus" class="mr-2 h-5 w-5"></i>
                        Create Request
                    </button>
                </div>

                <!-- Filters -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div class="relative">
                        <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"></i>
                        <input type="text" placeholder="Search by name or recipient..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition">
                    </div>
                    <select class="w-full py-2 px-4 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition">
                        <option>All Statuses</option>
                        <option>Pending</option>
                        <option>Completed</option>
                        <option>Overdue</option>
                        <option>Canceled</option>
                    </select>
                    <input type="date" class="w-full py-2 px-4 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-gray-500" value="2025-01-01">
                    <input type="date" class="w-full py-2 px-4 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-gray-500" value="2025-12-31">
                </div>

                <!-- Requests Table -->
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Request Name</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Recipient(s)</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date Sent</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Due Date</th>
                                <th scope="col" class="relative px-6 py-3"><span class="sr-only">Actions</span></th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                             <!-- NEW ROW: Multi-response request -->
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Workforce Development Survey</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Multiple (3)</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="px-3 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"><i data-lucide="message-square" class="mr-1.5 h-4 w-4"></i>3 Responses Received</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-10</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-09-01</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
                                    <button onclick="openModal('reviewMultiUpdatesModal')" class="flex items-center text-indigo-600 hover:text-indigo-900 transition"><i data-lucide="eye" class="h-5 w-5 mr-1"></i>Review Responses</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Annual Business Survey 2025</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">john.doe@innovatech.com</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="px-3 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"><i data-lucide="check-circle-2" class="mr-1.5 h-4 w-4"></i>Completed</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-15</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-01</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
                                    <button onclick="openModal('reviewUpdatesModal')" class="flex items-center text-indigo-600 hover:text-indigo-900 transition"><i data-lucide="eye" class="h-5 w-5 mr-1"></i>Review</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Project Site Plan Update</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">sara.connor@buildwell.com</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="px-3 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800"><i data-lucide="clock" class="mr-1.5 h-4 w-4"></i>Pending</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-05</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-20</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-4">
                                    <button class="text-blue-600 hover:text-blue-900 transition" title="Send Reminder"><i data-lucide="send"></i></button>
                                    <button class="text-red-600 hover:text-red-900 transition" title="Cancel Request"><i data-lucide="x-circle"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Q2 Financials Request</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">finance@acmecorp.com</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="px-3 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"><i data-lucide="alert-circle" class="mr-1.5 h-4 w-4"></i>Overdue</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-01</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600 font-bold">2025-07-15</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-4">
                                     <button class="text-blue-600 hover:text-blue-900 transition" title="Send Reminder"><i data-lucide="send"></i></button>
                                    <button class="text-red-600 hover:text-red-900 transition" title="Cancel Request"><i data-lucide="x-circle"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                 <!-- Pagination -->
                <div class="flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-4 rounded-b-xl">
                    <div class="flex flex-1 justify-between sm:hidden">
                        <a href="#" class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Previous</a>
                        <a href="#" class="relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Next</a>
                    </div>
                    <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
                        <div>
                        <p class="text-sm text-gray-700">
                            Showing
                            <span class="font-medium">1</span>
                            to
                            <span class="font-medium">4</span>
                            of
                            <span class="font-medium">4</span>
                            results
                        </p>
                        </div>
                        <div>
                        <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
                            <a href="#" class="relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                            <span class="sr-only">Previous</span>
                            <i data-lucide="chevron-left" class="h-5 w-5"></i>
                            </a>
                            <a href="#" aria-current="page" class="relative z-10 inline-flex items-center bg-civicserve px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2">1</a>
                            <a href="#" class="relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                            <span class="sr-only">Next</span>
                            <i data-lucide="chevron-right" class="h-5 w-5"></i>
                            </a>
                        </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contextual View -->
        <div id="contextual-view" class="hidden">
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                 <!-- Notification Banner -->
                <div id="review-banner" class="bg-indigo-50 border-l-4 border-indigo-500 text-indigo-800 p-4 mb-6 rounded-md" role="alert">
                    <div class="flex">
                        <div class="py-1"><i data-lucide="info" class="h-6 w-6 text-indigo-500 mr-4"></i></div>
                        <div>
                            <p class="font-bold">Updates Ready for Review</p>
                            <p class="text-sm">Innovatech Solutions has submitted new information for the "Annual Business Survey 2025".</p>
                            <button onclick="openModal('reviewUpdatesModal')" class="mt-2 inline-flex items-center font-bold text-indigo-700 hover:text-indigo-900 group">
                                Review Submitted Data <i data-lucide="arrow-right" class="ml-2 h-4 w-4 transition-transform group-hover:translate-x-1"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Business Header -->
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6 pb-6 border-b">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Innovatech Solutions</h1>
                        <p class="text-gray-500">123 Tech Park Ave, Silicon Valley, CA 94043</p>
                    </div>
                    <button onclick="openModal('createRequestModal', true)" class="mt-4 md:mt-0 flex items-center justify-center bg-civicserve text-white font-semibold py-2 px-4 rounded-lg shadow-sm transition duration-300" style="background-color: #003760 !important;">
                        <i data-lucide="mail-question" class="mr-2 h-5 w-5"></i>
                        Request Information
                    </button>
                </div>

                <!-- Business Details -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <h3 class="font-semibold text-lg text-gray-800">Company Information</h3>
                        <div>
                            <label class="text-sm font-medium text-gray-500">Primary Contact</label>
                            <p class="text-gray-800 font-medium">John Doe</p>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-500">Number of Employees</label>
                            <p class="text-gray-800 font-medium">150</p>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-500">Annual Revenue</label>
                            <p class="text-gray-800 font-medium">$25,000,000</p>
                        </div>
                    </div>
                     <div class="space-y-4">
                        <h3 class="font-semibold text-lg text-gray-800">Industry Details</h3>
                        <div>
                            <label class="text-sm font-medium text-gray-500">Services Offered</label>
                            <p class="text-gray-800 font-medium">Cloud Solutions, AI Development, Data Analytics</p>
                        </div>
                         <div>
                            <label class="text-sm font-medium text-gray-500">NAICS Code</label>
                            <p class="text-gray-800 font-medium">541511</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- External Recipient View -->
        <div id="external-view" class="hidden">
            <div class="max-w-2xl mx-auto">
                <div id="external-form-container" class="bg-white p-8 rounded-xl shadow-lg border border-gray-200">
                    <div class="text-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900">Information Request</h1>
                        <p class="text-gray-500 mt-1">from <span class="font-semibold">Bloomington Economic Development</span></p>
                         <p class="text-sm text-gray-500 mt-2">Please provide the following information for <span class="font-semibold">Innovatech Solutions</span>.</p>
                    </div>
                    <div class="space-y-6">
                        <div>
                            <label for="employees" class="block text-sm font-medium text-gray-700">Number of Employees</label>
                            <input type="number" name="employees" id="employees" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="e.g., 175">
                        </div>
                        <div>
                            <label for="revenue" class="block text-sm font-medium text-gray-700">Annual Revenue</label>
                            <div class="relative mt-1 rounded-md shadow-sm">
                                <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" name="revenue" id="revenue" class="block w-full rounded-md border-gray-300 pl-7 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="e.g., 28,500,000">
                            </div>
                        </div>
                        <div>
                            <label for="cover-photo" class="block text-sm font-medium text-gray-700">Upload Updated Site Plan</label>
                            <div class="mt-1 flex justify-center rounded-md border-2 border-dashed border-gray-300 px-6 pt-5 pb-6 hover:border-indigo-500 transition">
                                <div class="space-y-1 text-center">
                                    <i data-lucide="upload-cloud" class="mx-auto h-12 w-12 text-gray-400"></i>
                                    <div class="flex text-sm text-gray-600">
                                        <label for="file-upload" class="relative cursor-pointer rounded-md bg-white font-medium text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-500 focus-within:ring-offset-2 hover:text-indigo-500">
                                            <span>Upload a file</span>
                                            <input id="file-upload" name="file-upload" type="file" class="sr-only">
                                        </label>
                                        <p class="pl-1">or drag and drop</p>
                                    </div>
                                    <p class="text-xs text-gray-500">PNG, JPG, PDF up to 25MB</p>
                                </div>
                            </div>
                        </div>
                        <button onclick="showSuccessMessage()" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium bg-civicserve text-white focus:outline-none focus:ring-2 focus:ring-offset-2" style="background-color: #003760 !important;">Submit Information</button>
                    </div>
                </div>
                <div id="success-message" class="hidden bg-white p-8 rounded-xl shadow-lg text-center border border-gray-200">
                    <div class="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100">
                        <i data-lucide="check" class="h-6 w-6 text-green-600"></i>
                    </div>
                    <h2 class="mt-4 text-2xl font-bold text-gray-800">Submission Successful!</h2>
                    <p class="mt-2 text-gray-600">Thank you. Your information has been sent to Bloomington Economic Development.</p>
                    <p class="mt-1 text-sm text-gray-500">You can now close this window.</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Create Request Modal -->
    <div id="createRequestModal" class="modal-backdrop">
        <div class="modal-content">
            <div class="flex justify-between items-start">
                <h2 class="text-xl font-bold text-gray-800">Create New Information Request</h2>
                <button onclick="closeModal('createRequestModal')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="h-6 w-6"></i>
                </button>
            </div>
            
            <!-- Stepper -->
            <div class="flex items-center my-8">
                <div class="flex flex-col items-center">
                    <div class="step-indicator active" id="step-indicator-1">1</div>
                    <p class="text-sm mt-2 text-center font-semibold text-indigo-600" id="step-label-1">Details</p>
                </div>
                <div class="step-line" id="step-line-1"></div>
                <div class="flex flex-col items-center">
                    <div class="step-indicator inactive" id="step-indicator-2">2</div>
                    <p class="text-sm mt-2 text-center text-gray-500" id="step-label-2">Data</p>
                </div>
                <div class="step-line" id="step-line-2"></div>
                 <div class="flex flex-col items-center">
                    <div class="step-indicator inactive" id="step-indicator-3">3</div>
                    <p class="text-sm mt-2 text-center text-gray-500" id="step-label-3">Review</p>
                </div>
            </div>

            <!-- Step 1: Define Request -->
            <div id="step-1" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700">Request Name</label>
                    <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500" placeholder="e.g., Annual Business Survey 2025">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Recipient(s)</label>
                    <input type="email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500" placeholder="john.doe@example.com, sara.connor@example.com">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Due Date (Optional)</label>
                    <input type="date" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div class="flex justify-end pt-4">
                    <button onclick="goToStep(2)" class="bg-civicserve text-white font-semibold py-2 px-6 rounded-lg transition">Next</button>
                </div>
            </div>

            <!-- Step 2: Select Data -->
            <div id="step-2" class="hidden space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                     <div>
                        <label class="block text-sm font-medium text-gray-700">Select Module</label>
                        <select id="module-select" onchange="updateRecordAndFields()" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                            <option>Business</option>
                            <option>Project</option>
                            <option>Contact</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Select Record</label>
                        <select id="record-select" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                            <option>Innovatech Solutions</option>
                            <option>Acme Corp</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Select Fields to Request</label>
                    <div id="fields-container" class="mt-2 grid grid-cols-2 md:grid-cols-3 gap-4 border p-4 rounded-md max-h-48 overflow-y-auto bg-gray-50">
                        <!-- Fields will be populated by JS -->
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Custom Message</label>
                    <textarea rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500" placeholder="Please provide the following information..."></textarea>
                </div>
                <div class="flex justify-between pt-4">
                    <button onclick="goToStep(1)" class="bg-gray-200 text-gray-800 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Back</button>
                    <button onclick="goToStep(3)" class="bg-civicserve text-white font-semibold py-2 px-6 rounded-lg transition">Next</button>
                </div>
            </div>

            <!-- Step 3: Review -->
            <div id="step-3" class="hidden space-y-4">
                 <div class="space-y-3 bg-gray-50 p-4 rounded-lg border">
                    <p><strong>Request Name:</strong> Annual Business Survey 2025</p>
                    <p><strong>Recipient:</strong> john.doe@innovatech.com</p>
                    <p><strong>Record:</strong> Innovatech Solutions (Business)</p>
                    <p><strong>Requested Fields:</strong></p>
                    <ul class="list-disc list-inside text-sm pl-2">
                        <li>Number of Employees</li>
                        <li>Annual Revenue</li>
                        <li>Site Plan (File Upload)</li>
                    </ul>
                </div>
                <div class="flex justify-between pt-4">
                    <button onclick="goToStep(2)" class="bg-gray-200 text-gray-800 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Back</button>
                    <button onclick="closeModal('createRequestModal')" class="bg-green-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-green-700 transition flex items-center"><i data-lucide="send" class="h-4 w-4 mr-2"></i>Send Request</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Review Updates Modal (Single Response) -->
    <div id="reviewUpdatesModal" class="modal-backdrop">
        <div class="modal-content">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h2 class="text-xl font-bold text-gray-800">Review Submitted Information</h2>
                    <p class="text-sm text-gray-600 mt-1">From "Annual Business Survey 2025" for Innovatech Solutions.</p>
                </div>
                <button onclick="closeModal('reviewUpdatesModal')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="h-6 w-6"></i>
                </button>
            </div>
            
            <div class="space-y-4 max-h-[60vh] overflow-y-auto pr-2">
                <!-- Field for review -->
                <div class="bg-white p-4 rounded-lg border border-gray-200">
                    <label class="block text-sm font-bold text-gray-700 mb-2">Number of Employees</label>
                    <div class="flex items-center space-x-4">
                        <div class="flex-1">
                            <p class="text-xs text-gray-500">Current Data</p>
                            <p class="font-medium text-gray-500 line-through p-2">150</p>
                        </div>
                        <i data-lucide="arrow-right" class="text-gray-400"></i>
                        <div class="flex-1">
                            <p class="text-xs text-green-600 font-semibold">Submitted Data</p>
                            <p class="font-medium text-green-800 p-2 bg-green-50 rounded border border-green-300">175</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="p-2 rounded-full hover:bg-red-100 text-red-600 transition" title="Reject"><i data-lucide="x"></i></button>
                            <button class="p-2 rounded-full hover:bg-green-100 text-green-600 transition" title="Approve"><i data-lucide="check"></i></button>
                        </div>
                    </div>
                </div>
                 <!-- Field for review -->
                <div class="bg-white p-4 rounded-lg border border-gray-200">
                    <label class="block text-sm font-bold text-gray-700 mb-2">Annual Revenue</label>
                     <div class="flex items-center space-x-4">
                        <div class="flex-1">
                            <p class="text-xs text-gray-500">Current Data</p>
                            <p class="font-medium text-gray-500 line-through p-2">$25,000,000</p>
                        </div>
                        <i data-lucide="arrow-right" class="text-gray-400"></i>
                        <div class="flex-1">
                            <p class="text-xs text-green-600 font-semibold">Submitted Data</p>
                            <p class="font-medium text-green-800 p-2 bg-green-50 rounded border border-green-300">$28,500,000</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="p-2 rounded-full hover:bg-red-100 text-red-600 transition" title="Reject"><i data-lucide="x"></i></button>
                            <button class="p-2 rounded-full hover:bg-green-100 text-green-600 transition" title="Approve"><i data-lucide="check"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-6 flex justify-end space-x-3 border-t pt-4">
                <button onclick="closeModal('reviewUpdatesModal')" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 transition">Cancel</button>
                <button onclick="closeModal('reviewUpdatesModal')" class="bg-civicserve text-white font-semibold py-2 px-4 rounded-lg transition">Approve All & Save</button>
            </div>
        </div>
    </div>

    <!-- UPDATED MODAL: Review Multiple Updates -->
    <div id="reviewMultiUpdatesModal" class="modal-backdrop">
        <div class="modal-content">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h2 class="text-xl font-bold text-gray-800">Review Multiple Submissions</h2>
                    <p class="text-sm text-gray-600 mt-1">From "Workforce Development Survey". Select the response(s) to approve for each field.</p>
                </div>
                <button onclick="closeModal('reviewMultiUpdatesModal')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="h-6 w-6"></i>
                </button>
            </div>
            
            <div class="space-y-6 max-h-[60vh] overflow-y-auto pr-2">
                <!-- Field Group for Review -->
                <div class="bg-gray-50 p-4 rounded-lg border">
                    <label class="block text-base font-bold text-gray-800 mb-2">Number of Open Positions</label>
                    <p class="text-sm text-gray-600 mb-4">Current Data: <span class="font-semibold bg-gray-200 px-2 py-1 rounded">12</span></p>
                    
                    <div class="space-y-3">
                        <!-- Response 1 -->
                        <label class="flex items-center bg-white p-3 rounded-md border has-[:checked]:border-indigo-600 has-[:checked]:ring-2 has-[:checked]:ring-indigo-200 transition cursor-pointer">
                            <input type="checkbox" name="open-positions-1" class="h-4 w-4 rounded text-indigo-600 border-gray-300 focus:ring-indigo-500">
                            <div class="ml-3 flex-grow">
                                <p class="font-semibold text-gray-800">15</p>
                                <p class="text-xs text-gray-500">Submitted by: hr@innovatech.com</p>
                            </div>
                        </label>
                        <!-- Response 2 -->
                        <label class="flex items-center bg-white p-3 rounded-md border has-[:checked]:border-indigo-600 has-[:checked]:ring-2 has-[:checked]:ring-indigo-200 transition cursor-pointer">
                            <input type="checkbox" name="open-positions-2" class="h-4 w-4 rounded text-indigo-600 border-gray-300 focus:ring-indigo-500">
                            <div class="ml-3 flex-grow">
                                <p class="font-semibold text-gray-800">14</p>
                                <p class="text-xs text-gray-500">Submitted by: ceo@innovatech.com</p>
                            </div>
                        </label>
                         <!-- Response 3 -->
                        <label class="flex items-center bg-white p-3 rounded-md border has-[:checked]:border-indigo-600 has-[:checked]:ring-2 has-[:checked]:ring-indigo-200 transition cursor-pointer">
                            <input type="checkbox" name="open-positions-3" class="h-4 w-4 rounded text-indigo-600 border-gray-300 focus:ring-indigo-500">
                             <div class="ml-3 flex-grow">
                                <p class="font-semibold text-gray-800">15</p>
                                <p class="text-xs text-gray-500">Submitted by: ops@innovatech.com</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Field Group for Review -->
                <div class="bg-gray-50 p-4 rounded-lg border">
                    <label class="block text-base font-bold text-gray-800 mb-2">Top Hiring Challenge</label>
                    <p class="text-sm text-gray-600 mb-4">Current Data: <span class="font-semibold bg-gray-200 px-2 py-1 rounded">Not specified</span></p>
                    
                    <div class="space-y-3">
                        <!-- Response 1 -->
                        <label class="flex items-center bg-white p-3 rounded-md border has-[:checked]:border-indigo-600 has-[:checked]:ring-2 has-[:checked]:ring-indigo-200 transition cursor-pointer">
                            <input type="checkbox" name="hiring-challenge-1" class="h-4 w-4 rounded text-indigo-600 border-gray-300 focus:ring-indigo-500">
                            <div class="ml-3 flex-grow">
                                <p class="font-semibold text-gray-800">Lack of qualified candidates</p>
                                <p class="text-xs text-gray-500">Submitted by: hr@innovatech.com</p>
                            </div>
                        </label>
                        <!-- Response 2 -->
                        <label class="flex items-center bg-white p-3 rounded-md border has-[:checked]:border-indigo-600 has-[:checked]:ring-2 has-[:checked]:ring-indigo-200 transition cursor-pointer">
                            <input type="checkbox" name="hiring-challenge-2" class="h-4 w-4 rounded text-indigo-600 border-gray-300 focus:ring-indigo-500">
                            <div class="ml-3 flex-grow">
                                <p class="font-semibold text-gray-800">Competition from other employers</p>
                                <p class="text-xs text-gray-500">Submitted by: ceo@innovatech.com</p>
                            </div>
                        </label>
                         <!-- Response 3 -->
                        <label class="flex items-center bg-white p-3 rounded-md border has-[:checked]:border-indigo-600 has-[:checked]:ring-2 has-[:checked]:ring-indigo-200 transition cursor-pointer">
                            <input type="checkbox" name="hiring-challenge-3" class="h-4 w-4 rounded text-indigo-600 border-gray-300 focus:ring-indigo-500">
                             <div class="ml-3 flex-grow">
                                <p class="font-semibold text-gray-800">Lack of qualified local talent</p>
                                <p class="text-xs text-gray-500">Submitted by: ops@innovatech.com</p>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="mt-6 flex justify-end space-x-3 border-t pt-4">
                <button onclick="closeModal('reviewMultiUpdatesModal')" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 transition">Cancel</button>
                <button onclick="closeModal('reviewMultiUpdatesModal')" class="bg-civicserve text-white font-semibold py-2 px-4 rounded-lg transition">Approve & Log Selections</button>
            </div>
        </div>
    </div>


    <script>
        lucide.createIcons();

        const fieldsData = {
            Business: ['Number of Employees', 'Annual Revenue', 'Primary Contact', 'Services Offered', 'NAICS Code', 'Site Plan (File Upload)'],
            Project: ['Project Status', 'Estimated Cost', 'Completion Date', 'Project Manager', 'Architectural Drawings (File Upload)'],
            Contact: ['Job Title', 'Phone Number', 'Email Address', 'Mailing Address']
        };
        
        const recordData = {
            Business: ['Innovatech Solutions', 'Acme Corp', 'BuildWell Construction'],
            Project: ['Downtown Revitalization TIF', 'North Industrial Park Expansion', 'City Hall Renovation'],
            Contact: ['John Doe', 'Jane Smith', 'Peter Jones']
        }

        function showTab(tabName) {
            document.getElementById('hub-view').style.display = 'none';
            document.getElementById('contextual-view').style.display = 'none';
            document.getElementById('external-view').style.display = 'none';

            document.getElementById(`${tabName}-view`).style.display = 'block';

            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            lucide.createIcons();
        }

        function openModal(modalId, isContextual = false) {
             if (modalId === 'createRequestModal') {
                if (isContextual) {
                    // Pre-fill for contextual request
                    const moduleSelect = document.getElementById('module-select');
                    const recordSelect = document.getElementById('record-select');
                    moduleSelect.value = 'Business';
                    updateRecordAndFields(); // update records first
                    recordSelect.value = 'Innovatech Solutions';
                    updateRecordAndFields(); // then update fields
                    goToStep(2);
                } else {
                    // Reset to step 1 for a new request
                    goToStep(1);
                }
            }
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function goToStep(stepNumber) {
            // Hide all steps
            document.getElementById('step-1').style.display = 'none';
            document.getElementById('step-2').style.display = 'none';
            document.getElementById('step-3').style.display = 'none';

            // Show the target step
            document.getElementById(`step-${stepNumber}`).style.display = 'block';

            // Update stepper indicators
            for (let i = 1; i <= 3; i++) {
                const indicator = document.getElementById(`step-indicator-${i}`);
                const line = document.getElementById(`step-line-${i-1}`);
                const label = document.getElementById(`step-label-${i}`);
                
                indicator.classList.remove('active', 'complete', 'inactive');
                label.classList.remove('text-indigo-600', 'font-semibold', 'text-gray-500');

                if(line) line.classList.remove('complete');
                
                if (i < stepNumber) {
                    indicator.classList.add('complete');
                    if(line) line.classList.add('complete');
                    label.classList.add('text-gray-500');
                } else if (i === stepNumber) {
                    indicator.classList.add('active');
                    label.classList.add('text-indigo-600', 'font-semibold');
                } else {
                    indicator.classList.add('inactive');
                     label.classList.add('text-gray-500');
                }
            }
        }
        
        function updateRecordAndFields() {
            const module = document.getElementById('module-select').value;
            const recordSelect = document.getElementById('record-select');
            const fieldsContainer = document.getElementById('fields-container');
            
            // Update records
            recordSelect.innerHTML = '';
            recordData[module].forEach(record => {
                const option = document.createElement('option');
                option.value = record;
                option.textContent = record;
                recordSelect.appendChild(option);
            });

            // Update fields
            fieldsContainer.innerHTML = '';
            fieldsData[module].forEach(field => {
                const div = document.createElement('div');
                div.className = 'relative flex items-start';
                const id = `field-${field.replace(/\s+/g, '-')}`;
                div.innerHTML = `
                    <div class="flex h-5 items-center">
                        <input id="${id}" name="fields" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    </div>
                    <div class="ml-3 text-sm">
                        <label for="${id}" class="font-medium text-gray-700">${field}</label>
                    </div>
                `;
                fieldsContainer.appendChild(div);
            });
        }

        function showSuccessMessage() {
            document.getElementById('external-form-container').style.display = 'none';
            document.getElementById('success-message').style.display = 'block';
        }

        // Initial setup
        document.addEventListener('DOMContentLoaded', () => {
            showTab('hub');
            updateRecordAndFields();
            goToStep(1);
        });

    </script>
</body>
</html>
