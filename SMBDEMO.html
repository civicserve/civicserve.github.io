
<!DOCTYPE html>
<html lang="en" class="dxChrome dxMacOSPlatform dxWebKitFamily dxBrowserVersion-126 dxChrome dxMacOSPlatform dxWebKitFamily dxBrowserVersion-126" style="--c-landing-primary: 8,158,154; --c-landing-light20-primary-color: #0abeb9; --c-landing-light30-primary-color: #0acdc8; --c-landing-light35-primary-color: #0bd5d0; --c-landing-light40-primary-color: #0bddd8; --c-landing-darken10-primary-color: #078e8b; --c-landing-secondary: #ffa800; --c-primary-contrast: #003760;">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>Progress City - Community Goals, Activities & Impacts</title>
  <!--<base href="/">--><base href=".">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/x-icon" href="https://demo.civicserve.com/favicon.png">
  <script src="https://kit.fontawesome.com/1ad7921aa1.js" crossorigin="anonymous"></script>
  <link rel="stylesheet"  href="https://dmitri.github.io/projects/civicserve/cs-dashboard/src/application-base.css">
  <link rel="stylesheet"  href="https://dmitri.github.io/projects/civicserve/cs-dashboard/src/application-new.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
<script>
    window.Promise ||
    document.write(
        '<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"><\/script>'
    )
    window.Promise ||
    document.write(
        '<script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20171210/classList.min.js"><\/script>'
    )
    window.Promise ||
    document.write(
        '<script src="https://cdn.jsdelivr.net/npm/findindex_polyfill_mdn"><\/script>'
    )
</script>
    
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<style>

  h2, h3, h4, h5, h6 {
    font-family: 'Mulish', sans-serif;
    font-weight: normal;
    margin-bottom: 1.5rem;
  }

  .panel .panel-inner .panel-heading:before {
    content: "";
    position: absolute;
    height: 30px;
    width: 8px;
    background-color: rgba(var(--c-primary), .77);
    left: -15px;
    border-radius: 0 5px 5px 0;
    top: 50%;
    transform: translateY(-50%);
  }
  
  .chart-box {
    background-color: white;
    border-radius: 8px;
    padding: 15px;
    box-shadow: #0000000d 0 4px 12px;
  }
  
  .chart {
    height: 200px;
  }
  
  .chart-caption {
    text-align: center;
    margin-top: 10px;
    font-size: 14px;
    color: #666;
  }

  .grid-container {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 20px;
    width: 100%;
  }

  /* Below the point where 4 columns would be too narrow */
  @media (max-width: 1049px) {
    .grid-container {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }
  }

  .two-column-grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 20px;
    margin: 50px auto;
    width: 100%;
  }

  /* For screens narrower than 991px */
  @media (max-width: 991px) {
    .two-column-grid {
      grid-template-columns: 1fr;
      gap: 20px;
    }
  }

  .grid-container-agency {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 20px;
    width: 100%;
  }

  /* Below the point where 4 columns would be too narrow */
  @media (max-width: 1049px) {
    .grid-container-agency {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }
  }

  .fa-light.fa-circle {
    font-weight: 100;
  }
  
  .goal-icon.fa-stack {
    font-size: 1.5rem;
    text-align: center;
    width: 5em;
  }

  .goal-selector {
    height: 465px;
    overflow-y: scroll;
  }

  .scroll-indicator {
    text-align: center;
    font-size: .85rem;
    font-weight: normal;
    color: #555;
    width: 100%;
    position: absolute;
    left: 0;
    z-index: 0;
    transition: opacity 0.3s;
  }

  .scroll-up {
    top: -25px;
    opacity: 0;
  }

  .scroll-down {
    bottom: -25px;
    opacity: 0;
  }

  .progress-wrapper {
    position: relative;
    display: inline-block;
    /* No background color specified, so it remains transparent */
  }
  
  .progress-circle {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* SVG is transparent by default */
  }
  
  .progress-circle circle {
    fill: none;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s;
    transform-origin: center;
    /* Rotate to start at 12 o'clock */
    transform: rotate(-90deg);
  }
  
  .grow-4 {
    transform: scale(4);
  }

  /* Style for the drag handle to make it obvious it's draggable */
  .goal-drag-handle {
    cursor: grab;
    padding: 10px 5px;
    color: #888;
    transition: color 0.2s ease;
  }

  .goal-drag-handle:hover {
    color: #444;
  }

  .goal-drag-handle.dragging {
    cursor: grabbing;
    color: #4CAF50;
  }

  /* Style for the item being dragged */
  .goal-btn.dragging-item {
    opacity: 0.5;
    cursor: grabbing;
  }

  /* Styles for the drag-over indicators */
  .goal-btn.drag-over-top {
    border-top: 2px solid #4CAF50;
  }

  .goal-btn.drag-over-bottom {
    border-bottom: 2px solid #4CAF50;
  }

  /* Add a transition for smoother reordering */
  .goal-btn {
    transition: transform 0.2s ease;
  }

  .panel-heading {
    align-self: flex-start; margin-bottom: 2rem;
  }

  .chart-container-combined {
    width: 100%;
  }

  #combinedAgencyChart {
    width: 100%;
    min-height: 400px;
  }

  .time-period-selector {
  display: flex;
  align-items: center;
}

.time-period-label {
  font-weight: bold;
  margin-right: 15px;
}

.time-period-options {
  display: flex;
  gap: 10px;
}

.time-btn.active {
  background-color: rgb(var(--c-primary));
  color: white;
  border-color: rgb(var(--c-primary));
}

.metrics-card-number {
  font-size: 2.5rem;
  font-weight: 600;
  line-height: 3rem;
  padding-top: 0;
}

.metrics-card-percentage {
   display: flex; justify-content: center; align-items: center; flex-direction: row;
   padding-top: .5rem;
   font-size: 1.25rem;
}

.metrics-card-percentage-positive {
  color: #468b5b;
}

.metrics-card-percentage-negative {
  color: #ee233b;
}

.metrics-card-change {
  font-size: .9rem; color: #444;
}

.metrics-card .metrics-card-title-wrapper .title {
  font-size: 1.1rem;
  white-space: nowrap;
}

/* Add this CSS to create a subtle animation when metrics cards update */
@keyframes pulse {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
  100% {
    opacity: 1;
  }
}

.metrics-card-updating {
  animation: pulse 0.5s ease;
}

.metrics-card-percentage-positive {
  color: #4CAF50;
}

.metrics-card-percentage-negative {
  color: #F44336;
}

/* Ensure the metrics card elements have transitions for smooth updates */
.metrics-card-number, 
.metrics-card-percentage-number {
  transition: all 0.3s ease;
}

/* Custom Date Button */
.time-btn[data-period="custom"] {
  position: relative;
}

/* Calendar Popup */
.calendar-popup {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  justify-content: center;
  align-items: center;
}

.calendar-popup.active {
  display: flex;
}

.calendar-popup-content {
  background-color: white;
  border-radius: 6px;
  width: 350px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.calendar-header {
  padding: 15px;
  border-bottom: 1px solid #eee;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.calendar-header h4 {
  margin: 0;
  font-size: 16px;
}

.calendar-close {
  background: none;
  border: none;
  font-size: 20px;
  cursor: pointer;
  color: #666;
}

.calendar-body {
  padding: 20px;
}

.date-group {
  margin-bottom: 15px;
}

.date-group label {
  display: block;
  margin-bottom: 5px;
  font-weight: 500;
}

.date-input {
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.calendar-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #eee;
}

.btn-cancel, 
.btn-apply {
  padding: 8px 15px;
  border-radius: 4px;
  border: none;
  font-size: 14px;
  cursor: pointer;
  margin-left: 10px;
}

.btn-cancel {
  background-color: #f5f5f5;
  color: #333;
}

.btn-apply {
  background-color: #4CAF50;
  color: white;
}

/* When a custom range is active */
.time-btn.active[data-period="custom"]::after {
  content: '';
  position: absolute;
  bottom: -5px;
  left: 50%;
  transform: translateX(-50%);
  width: 8px;
  height: 8px;
  background-color: #4CAF50;
  border-radius: 50%;
}

.time-period-options {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 10px;
}

.inline-date-selector {
  display: flex;
  align-items: center;
  gap: 10px;
}

.date-input-group {
  display: flex;
  align-items: center;
  gap: 5px;
}

.date-input {
  width: 150px;
  font-size: 14px;
  padding: 6px 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.date-separator {
  margin: 0 5px;
  color: #666;
}

/* Responsive adjustments */
@media (max-width: 992px) {
  .time-period-options {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .inline-date-selector {
    margin-top: 10px;
    width: 100%;
  }
  
  .date-input-group {
    flex-grow: 1;
  }
  
  .date-input {
    width: 100%;
  }
}

@media (max-width: 576px) {
  .date-input-group {
    flex-direction: column;
    width: 100%;
  }
  
  .inline-date-selector {
    flex-direction: column;
    width: 100%;
  }
  
  .date-input {
    width: 100%;
  }
  
  #applyDateRange {
    width: 100%;
    margin-top: 10px;
  }
}

.active-date-input {
  border-color: #4CAF50 !important;
  box-shadow: 0 0 0 0.2rem rgba(76, 175, 80, 0.25) !important;
}

</style>
</head>

<body class="dx-device-desktop dx-device-generic" style="overflow: unset;">
  <div id="root">
      <div class="container-fluid p-0 dx-viewport" data-theme="light">
          <div id="loader" class="linear-activity" style="display: none;">
              <div class="indeterminate"></div>
          </div>
          <div class="header-content-wrapper">
              <div>
                  <div class="header-wrapper">
                      <div class="align-self-center header-left-wrapper">
                          <button class="btn side-nav-toggle-btn px-0">
                              <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                  <path fill="currentColor" d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path>
                              </svg>
                          </button>
                          <a href="https://demo2.civicserve.com/admin"><img src="https://dmitri.github.io/projects/civicserve/cs-dashboard/src/cs-logo-white.png"></a>
                      </div>
                      <form class="search-wrapper">
                          <div class="search-input">
                              <div class="search-icon">
                                  <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="magnifying-glass" class="svg-inline--fa fa-magnifying-glass " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                      <path fill="currentColor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path>
                                  </svg>
                              </div>
                              <div class="form-control dx-show-invalid-badge dx-textbox dx-texteditor dx-editor-outlined dx-texteditor-empty dx-widget dx-dropdowneditor dx-autocomplete">
                                  <div class="dx-dropdowneditor-input-wrapper">
                                      <div class="dx-texteditor-container">
                                          <div class="dx-texteditor-input-container">
                                              <input autocomplete="off" placeholder="Search Programs, Projects, or Contacts" class="dx-texteditor-input" aria-haspopup="listbox" aria-autocomplete="inline" type="text" spellcheck="false" tabindex="0" role="combobox"
                                              aria-expanded="false">
                                              <div id="dx-9d0b18eb-fb11-2057-801c-15194d767a80" data-dx_placeholder="Search Programs, Projects, or Contacts" class="dx-placeholder"></div>
                                          </div>
                                          <div class="dx-texteditor-buttons-container">
                                              <div></div>
                                              <div></div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="select-dropdown">
                              <select class="form-select">
                                  <option>All</option>
                                  <option>Programs</option>
                                  <option>Projects</option>
                                  <option>Contacts</option>
                              </select>
                          </div>
                      </form>
                      <div class="header-right align-self-center">
                          <div class="header-support-wrapper">
                              <div class="dx-show-invalid-badge dx-selectbox dx-textbox dx-texteditor dx-dropdowneditor-button-visible dx-editor-outlined dx-texteditor-empty dx-widget dx-dropdowneditor dx-dropdowneditor-field-clickable">
                                  <div class="dx-dropdowneditor-input-wrapper dx-selectbox-container">
                                      <input type="hidden" value="">
                                      <div class="dx-texteditor-container">
                                          <div class="dx-texteditor-input-container">
                                              <input autocomplete="off" placeholder="Select..." class="dx-texteditor-input" aria-haspopup="listbox" aria-autocomplete="list" type="text" readonly="" spellcheck="false" tabindex="0" role="combobox" aria-expanded="false">
                                              <div id="dx-36a87714-21bc-61a0-5e59-501d46dc27f6" data-dx_placeholder="Select..." class="dx-placeholder"></div>
                                          </div>
                                          <div class="dx-texteditor-buttons-container">
                                              <div></div>
                                              <div role="button" class="dx-widget dx-button-normal dx-dropdowneditor-button" aria-label="Select">
                                                  <div class="dx-button-content">
                                                      <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="circle-question" class="svg-inline--fa fa-circle-question " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                          <path fill="currentColor" d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path>
                                                      </svg>
                                                      <div style="display: none;"></div>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="d-flex">
                              <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="list-check" class="svg-inline--fa fa-list-check " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="tasks">
                                  <path fill="currentColor" d="M153.8 72.1c8.9-9.9 8.1-25-1.8-33.9s-25-8.1-33.9 1.8L63.1 101.1 41 79C31.6 69.7 16.4 69.7 7 79s-9.4 24.6 0 33.9l40 40c4.7 4.7 11 7.2 17.6 7s12.8-3 17.2-7.9l72-80zm0 160c8.9-9.9 8.1-25-1.8-33.9s-25-8.1-33.9 1.8L63.1 261.1 41 239c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l40 40c4.7 4.7 11 7.2 17.6 7s12.8-3 17.2-7.9l72-80zM216 120H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H216c-13.3 0-24 10.7-24 24s10.7 24 24 24zM192 256c0 13.3 10.7 24 24 24H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H216c-13.3 0-24 10.7-24 24zM160 416c0 13.3 10.7 24 24 24H488c13.3 0 24-10.7 24-24s-10.7-24-24-24H184c-13.3 0-24 10.7-24 24zm-64 0a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path>
                              </svg>
                              <div class="dx-overlay dx-popup dx-popover dx-widget dx-state-invisible dx-visibility-change-handler">
                                  <div class="dx-overlay-content dx-popup-normal" role="tooltip" style="width: 350px; height: auto;">
                                      <div class="dx-popover-arrow"></div>
                                      <div class="dx-popup-content dx-popup-content-scrollable"></div>
                                  </div>
                              </div>
                          </div>
                          <div class="user-details-wrapper">
                              <div class="user-details-container">
                                  <div class="dx-show-invalid-badge dx-selectbox dx-textbox dx-texteditor dx-dropdowneditor-button-visible dx-editor-outlined dx-texteditor-empty dx-widget dx-dropdowneditor dx-dropdowneditor-field-clickable">
                                      <div class="dx-dropdowneditor-input-wrapper dx-selectbox-container">
                                          <input type="hidden" value="">
                                          <div class="dx-texteditor-container">
                                              <div class="dx-texteditor-input-container">
                                                  <input autocomplete="off" placeholder="Select..." class="dx-texteditor-input" aria-haspopup="listbox" aria-autocomplete="list" type="text" readonly="" spellcheck="false" tabindex="0" role="combobox" aria-expanded="false">
                                                  <div id="dx-3b10a7bb-971d-b6c2-5685-8b51854b3d18" data-dx_placeholder="Select..." class="dx-placeholder"></div>
                                              </div>
                                              <div class="dx-texteditor-buttons-container">
                                                  <div></div>
                                                  <div role="button" class="dx-widget dx-button-normal dx-dropdowneditor-button" aria-label="Select">
                                                      <div class="dx-button-content">
                                                          <div class="user-details-wrapper">
                                                              <div>
                                                                  <div class="name-initial-container">
                                                                      <div id="name">DD</div>
                                                                  </div>
                                                              </div>
                                                              <div class="user-details">
                                                                  <div class="user-name">Gary Gov</div>
                                                                  <div class="user-role">Admin</div>
                                                              </div>
                                                          </div>
                                                          <div style="display: none;"></div>
                                                      </div>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          <div class="content-wrapper">
              <div class="overlay-effect"></div>
              <nav class="side-nav ">
                <div class="side-nav-tooltip" style="top: 0px; left: 120px; opacity: 1; display: none;">
                    <div class="arrow"></div>
                    <div>
                        <div></div>
                    </div>
                </div>
                <ul class="side-nav-list">
                  <li>
                      <a class="menu-item ">
                          <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="chart-bar" class="svg-inline--fa fa-chart-bar menu-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                              <path fill="currentColor" d="M24 32c13.3 0 24 10.7 24 24V456c0 13.3 10.7 24 24 24H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H72c-39.8 0-72-32.2-72-72V56C0 42.7 10.7 32 24 32zM128 136c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V136zm96-88c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V48zM320 200c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V200zm96-88c0-13.3 10.7-24 24-24s24 10.7 24 24V424c0 13.3-10.7 24-24 24s-24-10.7-24-24V112z"></path>
                          </svg>
                          <div class="menu-label">Data</div>
                          <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                              <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                          </svg>
                      </a>
                      <ul class="sub-menu">
                          <li>
                              <a class="menu-item ">
                                  <div class="menu-label">Core Data</div>
                                  <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                                  </svg>
                              </a>
                              <ul class="sub-menu">
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/contacts/businesses" target="_blank">
                                          <div class="menu-label">Local Business</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://test.civicserve.com/admin/contacts/businessfinder" target="_blank">
                                          <div class="menu-label">National Business</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/settings/districts-parcels" target="_blank">
                                          <div class="menu-label">Parcel Data (GIS)</div>
                                      </a>
                                  </li>
                              </ul>
                          </li>
                          <li>
                              <a class="menu-item ">
                                  <div class="menu-label">Updates to Data</div>
                                  <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                                  </svg>
                              </a>
                              <ul class="sub-menu">
                                  <li>
                                      <a class="menu-item " href="/admin/data/updates/alerts">
                                          <div class="menu-label">Alerts</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/data/updates/trends">
                                          <div class="menu-label">Trends</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/data/updates/predictions">
                                          <div class="menu-label">Predictions</div>
                                      </a>
                                  </li>
                              </ul>
                          </li>
                          <li>
                              <a class="menu-item ">
                                  <div class="menu-label">New Data Collection</div>
                                  <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                                  </svg>
                              </a>
                              <ul class="sub-menu">
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/contacts/businesses" target="_blank">
                                          <div class="menu-label">Portal</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/data/new-collection/collection-engine">
                                          <div class="menu-label">Collection Engine</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/settings/user-management/public-users" target="_blank">
                                          <div class="menu-label">Outside Agencies</div>
                                      </a>
                                  </li>
                              </ul>
                          </li>
                      </ul>
                  </li>
                  <li>
                      <a class="menu-item ">
                          <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="screwdriver-wrench" class="svg-inline--fa fa-screwdriver-wrench menu-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                              <path fill="currentColor" d="M64.7 34.6L160 107.9V160H107.9L34.6 64.7 64.7 34.6zM192 169.3c0-.4 0-.9 0-1.3V104c0-7.5-3.5-14.5-9.4-19L78.6 5C69.1-2.4 55.6-1.5 47 7L7 47c-8.5 8.5-9.4 22-2.1 31.6l80 104c4.5 5.9 11.6 9.4 19 9.4h64c.4 0 .9 0 1.3 0L271.2 293.9c-19.5 30-16.2 70.5 10.1 96.8l112 112c12.5 12.5 32.8 12.5 45.3 0l64-64c12.5-12.5 12.5-32.8 0-45.3l-112-112c-26.3-26.3-66.8-29.7-96.8-10.1L192 169.3zM304 304c17.7-17.7 46.3-17.7 64 0L480 416l-64 64L304 368c-17.7-17.7-17.7-46.3 0-64zM104 424a16 16 0 1 0 -32 0 16 16 0 1 0 32 0zM23.2 376.8C8.3 391.7 0 411.8 0 432.8C0 476.5 35.5 512 79.2 512c21 0 41.1-8.3 56-23.2L238.5 385.5c-5.7-11.2-9.3-23.1-10.9-35.3L112.1 465.7c-8.7 8.7-20.6 13.6-32.9 13.6c-25.7 0-46.6-20.8-46.6-46.6c0-12.3 4.9-24.2 13.6-32.9L189.1 257l-23.1-23.1L23.2 376.8zM479.4 160c0 44.8-23.1 84.1-58 106.8l23.5 23.5c40.7-29 67.2-76.6 67.2-130.3c0-24.8-5.7-48.3-15.7-69.3c-4.4-9.2-16.5-10.5-23.7-3.3l-67.9 67.9c-3 3-7.1 4.7-11.3 4.7H368c-8.8 0-16-7.2-16-16V118.6c0-4.2 1.7-8.3 4.7-11.3l67.9-67.9c7.2-7.2 5.9-19.3-3.3-23.7C400.3 5.7 376.8 0 352 0C296.1 0 246.9 28.6 218.3 72.1l26 20C266.8 56.3 306.7 32.6 352 32.6c10.3 0 20.2 1.2 29.7 3.5L333.6 84.2c-9.1 9.1-14.2 21.5-14.2 34.4V144c0 26.9 21.8 48.6 48.6 48.6h25.4c12.9 0 25.3-5.1 34.4-14.2l48.1-48.1c2.3 9.5 3.5 19.5 3.5 29.7z"></path>
                          </svg>
                          <div class="menu-label">Tools</div>
                          <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                              <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                          </svg>
                      </a>
                      <ul class="sub-menu">
                          <li>
                              <a class="menu-item ">
                                  <div class="menu-label">Core Tools</div>
                                  <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                                  </svg>
                              </a>
                              <ul class="sub-menu">
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/contacts/all" target="_blank">
                                          <div class="menu-label">CRM (Business Connections)</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/leads" target="_blank">
                                          <div class="menu-label">Leads (Potential Projects)</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/contacts/survey-management/surveys" target="_blank">
                                          <div class="menu-label">Survey (Business Responses)</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/contacts/marketing/campaigns" target="_blank">
                                          <div class="menu-label">Marketing</div>
                                      </a>
                                  </li>
                              </ul>
                          </li>
                          <li>
                              <a class="menu-item ">
                                  <div class="menu-label">Advanced Tools</div>
                                  <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                                  </svg>
                              </a>
                              <ul class="sub-menu">
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/programs/non-incentives/available-properties/listings" target="_blank">
                                          <div class="menu-label">Properties</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/programs/incentives" target="_blank">
                                          <div class="menu-label">Incentives</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/contacts/bre" target="_blank">
                                          <div class="menu-label">BRE</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="https://smbdemo.civicserve.com/admin/contacts/workforce" target="_blank">
                                          <div class="menu-label">Workforce</div>
                                      </a>
                                  </li>
                              </ul>
                          </li>
                      </ul>
                  </li>
                  <li>
                      <a class="menu-item active">
                          <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chart-pie-simple" class="svg-inline--fa fa-chart-pie-simple menu-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                              <path fill="currentColor" d="M495.4 240c9 0 16.6-7 16.6-16C512 100.3 411.7 0 288 0c-9 0-16 7.6-16 16.6V240H495.4zM176 288c0 26.5 21.5 48 48 48H421.1C394.7 410.6 323.6 464 240 464C134 464 48 378 48 272c0-83.6 53.4-154.7 128-181.1V288zM224 66.7c0-18.5-15.7-33.3-33.8-29.5C81.5 60.1 0 156.5 0 272C0 404.6 107.5 512 240 512c115.5 0 211.9-81.5 234.8-190.2c3.8-18.1-11-33.8-29.5-33.8H272 224V240 66.7z"></path>
                          </svg>
                          <div class="menu-label">Reports</div>
                          <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                              <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                          </svg>
                      </a>
                      <ul class="sub-menu">
                          <li>
                              <a class="menu-item ">
                                  <div class="menu-label">Core Reports</div>
                                  <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                                  </svg>
                              </a>
                              <ul class="sub-menu">
                                  <li>
                                      <a class="menu-item " href="/admin/reports/core/analytic">
                                          <div class="menu-label">Analytic Reports</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/reports/core/compliance">
                                          <div class="menu-label">Compliance Reports</div>
                                      </a>
                                  </li>
                              </ul>
                          </li>
                          <li>
                              <a class="menu-item ">
                                  <div class="menu-label">Advanced Reports</div>
                                  <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                      <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                                  </svg>
                              </a>
                              <ul class="sub-menu">
                                  <li>
                                      <a class="menu-item " href="/admin/reports/advanced/executive-summary">
                                          <div class="menu-label">Executive Summary</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/reports/advanced/goals-progress">
                                          <div class="menu-label">Goals Progress</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/reports/advanced/timelines">
                                          <div class="menu-label">Timelines (Projects, Programs)</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/reports/advanced/survey">
                                          <div class="menu-label">Survey</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/reports/advanced/business-metrics">
                                          <div class="menu-label">Business Metrics (Jobs, Salaries, etc.)</div>
                                      </a>
                                  </li>
                                  <li>
                                      <a class="menu-item " href="/admin/reports/advanced/custom-reports">
                                          <div class="menu-label">Custom Reports (engine)</div>
                                      </a>
                                  </li>
                              </ul>
                          </li>
                      </ul>
                  </li>
                  <li>
                      <a class="menu-item ">
                          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="plug" class="svg-inline--fa fa-plug menu-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                              <path fill="currentColor" d="M96 0C78.3 0 64 14.3 64 32v96h64V32c0-17.7-14.3-32-32-32zM288 0c-17.7 0-32 14.3-32 32v96h64V32c0-17.7-14.3-32-32-32zM32 160c-17.7 0-32 14.3-32 32s14.3 32 32 32v32c0 77.4 55 142 128 156.8V448c0 17.7 14.3 32 32 32s32-14.3 32-32V412.8C297 398 352 333.4 352 256V224c17.7 0 32-14.3 32-32s-14.3-32-32-32H32z"></path>
                          </svg>
                          <div class="menu-label">Other Applications/Integrations</div>
                          <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-xs action-icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                              <path fill="currentColor" d="M239 401c9.4 9.4 24.6 9.4 33.9 0L465 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-175 175L81 175c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9L239 401z"></path>
                          </svg>
                      </a>
                      <ul class="sub-menu">
                          <li>
                              <a class="menu-item " href="https://smbdemo.civicserve.com/admin/integrations/property-systems" target="_blank">
                                  <div class="menu-label">Property Systems</div>
                              </a>
                          </li>
                          <li>
                              <a class="menu-item " href="https://smbdemo.civicserve.com/admin/integrations/permitting-systems" target="_blank">
                                  <div class="menu-label">Permitting Systems</div>
                              </a>
                          </li>
                          <li>
                              <a class="menu-item " href="https://smbdemo.civicserve.com/admin/integrations/marketing-systems" target="_blank">
                                  <div class="menu-label">Marketing Systems</div>
                              </a>
                          </li>
                          <li>
                              <a class="menu-item " href="https://smbdemo.civicserve.com/admin/integrations/financial-systems" target="_blank">
                                  <div class="menu-label">Financial Systems</div>
                              </a>
                          </li>
                      </ul>
                  </li>
                  <div class="switch-wrapper">
                      <div>
                          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sun" class="svg-inline--fa fa-sun " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                              <path fill="currentColor" d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path>
                          </svg>
                        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sun" class="svg-inline--fa fa-sun " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path fill="currentColor" d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path>
                        </svg>
                    </div>
                    <label class="switch-theme">
                        <input type="checkbox"><span class="theme-slider round" id="toggle-switch"></span></label>
                    <div>
                        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="moon" class="svg-inline--fa fa-moon " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                            <path fill="currentColor" d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path>
                        </svg>
                    </div>
                </div>
                <div style="position: absolute; bottom: 0px; left: 5px; margin: 5px; display: flex; gap: 5px;">
                    <a href="/admin/customer-metrics">
                        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="space-station-moon-construction" class="svg-inline--fa fa-space-station-moon-construction " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="color: white; height: 0.5em;">
                            <path fill="currentColor" d="M512 256c0 7.8-.3 15.5-1 23.1C438.8 304.7 351.2 320 256 320s-182.8-15.3-255-40.9c-.7-7.6-1-15.3-1-23.1C0 114.6 114.6 0 256 0c57.8 0 111.1 19.1 153.9 51.4c3.9 2.9 6.1 7.5 6.1 12.4V80c0 8.8-7.2 16-16 16H368c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h48 16c8.8 0 16 7.2 16 16v32c0 8.8 7.2 16 16 16h31.9c8.1 0 14.9 6 15.5 14.1c.4 5.9 .6 11.9 .6 17.9zM256 512C134.9 512 33.4 427.9 6.8 314.8C79.4 338.4 164.7 352 256 352c44.3 0 87.3-3.2 128-9.2V368c0 8.8 7.2 16 16 16h32c8.8 0 16 7.2 16 16v19.3c0 3.9-1.4 7.7-4.1 10.5C397.2 480.4 330.3 512 256 512zM160 160a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm112 0a80 80 0 1 0 -160 0 80 80 0 1 0 160 0z"></path>
                        </svg>
                    </a>
                </div>
            </nav>
            <div class="main-content-wrapper">
                <div class="page-header" style="flex-direction: column;">
                    <div style="display: flex; flex-direction: row;">
                      <div class="page-header-left">
                          <h3>Executive Dashboard</h3>
                      </div>
                      <div class="page-header-right">
                          <div role="button" aria-label="Export" class=" dx-button btn btn-primary dx-button-normal dx-button-has-text dx-button-has-icon" tabindex="0">
                              <div><i class="fa-solid fa-download" style="margin-right: 1rem;"></i> <span class="dx-button-text">Export</span></div>
                          </div>
                      </div>
                    </div>
                    <div class="time-period-selector" style=" background: #FFF; border-radius: 8px; padding: 1rem;">
                      <div class="time-period-label">Time Period:</div>
                      <div class="time-period-options">
                        <button class="time-btn btn btn-outline-primary" data-period="week">This Week</button>
                        <button class="time-btn btn btn-outline-primary active" data-period="month">This Month</button>
                        <button class="time-btn btn btn-outline-primary" data-period="quarter">This Quarter</button>
                        <button class="time-btn btn btn-outline-primary" data-period="year">This Year</button>
                        - or -
                        <!-- Inline date range selector -->
                        <div class="inline-date-selector">
                          <div class="date-input-group">
                            <input type="date" id="startDate" class="date-input form-control">
                            <span class="date-separator">to</span>
                            <input type="date" id="endDate" class="date-input form-control">
                          </div>
                          <button id="applyDateRange" class="btn btn-outline-primary">Apply</button>
                        </div>
                      </div>
                    </div>
                </div>
                
                <div class="grid-container">
                  <div>
                    <div class="panel metrics-card c-2">
                      <div class="metrics-card-title-wrapper">
                        <div class="metrics-card-icon">
                          <i class="fa-solid fa-triangle-exclamation" style="color: #8a4b6f;" aria-hidden="true"></i>
                        </div>
                        <div class="title">Projects Out of Compliance</div>
                      </div>

                      <div class="metrics-card-content text-center">
                        <div class="metrics-card-number">23</div>
                        <div class="metrics-card-percentage metrics-card-percentage-positive text-center">
                          
                          <div class="metrics-card-percentage-number">25%</div>
                        </div>
                        <div class="metrics-card-change">vs previous 30 days</div>
                      </div>
                    </div>
                    <div class="metrics-card-footer c-2">
                      <a href="#" class="metrics-card-cta">See All <i class="fa-light fa-arrow-right" aria-hidden="true"></i></a>
                    </div>
                  </div>

                  <div>
                    <div class="panel metrics-card c-4">
                      <div class="metrics-card-title-wrapper">
                        <div class="metrics-card-icon">
                          <i class="fa-solid fa-list-check" style="color: #3862e5;" aria-hidden="true"></i>
                        </div>
                        <div class="title">Total Activities</div>
                      </div>

                      <div class="metrics-card-content text-center">
                        <div class="metrics-card-number">86</div>
                        <div class="metrics-card-percentage metrics-card-percentage-positive text-center">
                          
                          <div class="metrics-card-percentage-number">23%</div>
                        </div>
                        <div class="metrics-card-change">vs previous 30 days</div>
                        
                      </div>
                    </div>
                    <div class="metrics-card-footer c-4">
                      <a href="#" class="metrics-card-cta">See All <i class="fa-light fa-arrow-right" aria-hidden="true"></i></a>
                    </div>
                  </div>

                  <div>
                    <div class="panel metrics-card c-4">
                      <div class="metrics-card-title-wrapper">
                        <div class="metrics-card-icon">
                          <i class="fa-solid fa-calendar-clock" style="color:#3862e5;" aria-hidden="true"></i>
                        </div>
                        <div class="title">Upcoming Timeline Events</div>
                      </div>

                      <div class="metrics-card-content text-center">
                        <div class="metrics-card-number">70</div>
                        <div class="metrics-card-percentage metrics-card-percentage-positive text-center">
                          
                          <div class="metrics-card-percentage-number">8.7%</div>
                        </div>
                        <div class="metrics-card-change">vs previous 30 days</div>
                        
                      </div>
                    </div>
                    <div class="metrics-card-footer c-4">
                      <a href="#" class="metrics-card-cta">See All <i class="fa-light fa-arrow-right" aria-hidden="true"></i></a>
                    </div>
                  </div>

                  <div>
                    <div class="panel metrics-card c-6">
                      <div class="metrics-card-title-wrapper">
                        <div class="metrics-card-icon">
                          <i class="fa-solid fa-bars-progress" style="color:#468b5b;" aria-hidden="true"></i>
                        </div>
                        <div class="title">Goal Progress</div>
                      </div>

                      <div class="metrics-card-content text-center">
                        <div class="metrics-card-number">9</div>
                        <div class="metrics-card-percentage metrics-card-percentage-negative text-center">
                          
                          <div class="metrics-card-percentage-number">2.5%</div>
                        </div>
                        <div class="metrics-card-change">vs previous 30 days</div>
                        
                      </div>
                    </div>
                    <div class="metrics-card-footer c-6">
                      <a href="#" class="metrics-card-cta">See All <i class="fa-light fa-arrow-right" aria-hidden="true"></i></a>
                    </div>
                  </div>
                </div>
                <div class="two-column-grid">
                  <div class="panel">
                    <div class="panel-inner">
                      <h3 class="panel-heading">Economic Impact Indicators</h3>
                      <div class="grid-container-agency">
                        <div id="chart7"></div>
                        <div id="chart8"></div>
                        <div id="chart11"></div>
                        <div id="chart12"></div>
                      </div>
                    </div>
                  </div>
                  <div class="panel">
                    <div class="panel-inner">
                      <h3 class="panel-heading">Multi-Agency Activities</h3>
                      <div class="chart-container-combined">
                        <div id="combinedAgencyChart"></div>
                      </div>
                    </div>
                  </div>
                </div>

            </div>
          </div>
          </div>
        </div>
    </div>
</div>
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
  crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
  <script src="https://dmitri.github.io/projects/civicserve/cs-dashboard/src/application.js"></script>
  <script src="https://dmitri.github.io/projects/civicserve/js/chart-script.js"></script>
  <script>
    // Function to generate appropriate date categories based on the time period
function generateTimeBasedCategories(timePeriod) {
  const today = new Date();
  const categories = [];
  
  switch(timePeriod) {
    case 'week':
      // Daily labels for the past 7 days
      for (let i = 6; i >= 0; i--) {
        const date = new Date(today);
        date.setDate(today.getDate() - i);
        
        // Format as "Mon, Tue, Wed, etc."
        const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
        categories.push(dayName);
      }
      break;
      
    case 'month':
      // Weekly labels for the past 4 weeks
      for (let i = 3; i >= 0; i--) {
        const date = new Date(today);
        date.setDate(today.getDate() - (i * 7));
        
        // Format as M/D (e.g., 2/26)
        const month = date.getMonth() + 1;
        const day = date.getDate();
        categories.push(`${month}/${day}`);
      }
      break;
      
    case 'quarter':
      // Monthly labels for the past 3 months
      for (let i = 2; i >= 0; i--) {
        const date = new Date(today);
        date.setMonth(today.getMonth() - i);
        
        // Format as "Jan", "Feb", etc.
        const monthName = date.toLocaleDateString('en-US', { month: 'short' });
        categories.push(monthName);
      }
      // Add "Now"
      categories.push('Now');
      break;
      
    case 'year':
      // Quarterly labels for the past year
      const currentQuarter = Math.floor(today.getMonth() / 3) + 1;
      for (let i = 3; i >= 0; i--) {
        let quarterNum = currentQuarter - i;
        if (quarterNum <= 0) quarterNum += 4; // Wrap around to Q4 if needed
        categories.push(`Q${quarterNum}`);
      }
      break;
  }
  
  return categories;
}
// Function to parse ratio strings into numerical values
function parseRatio(ratioStr) {
  // Handle different formats of ratios
  if (typeof ratioStr === 'number') {
    return ratioStr; // Already a number, return as is
  }
  
  // Remove any whitespace
  const cleanStr = ratioStr.trim();
  
  // Check if it's in the format "1:5"
  if (cleanStr.includes(':')) {
    const [numerator, denominator] = cleanStr.split(':');
    
    // Convert to numbers, handling decimal points
    const num = parseFloat(numerator);
    const denom = parseFloat(denominator);
    
    if (!isNaN(num) && !isNaN(denom) && denom !== 0) {
      return num / denom; // Return as a decimal
    }
  }
  
  // If we can't parse it as a ratio, try to parse it as a single number
  const asNumber = parseFloat(cleanStr);
  if (!isNaN(asNumber)) {
    return asNumber;
  }
  
  // If all else fails, return null or a default value
  console.warn(`Couldn't parse ratio: ${ratioStr}`);
  return null;
}

// Store charts in a global array for easy access
const charts = [];

function generateDateCategories() {
  const today = new Date();
  const categories = [];
  
  // Get the 4 weeks, going backward from today
  for (let i = 3; i >= 0; i--) {
    // Clone today's date and subtract weeks
    const date = new Date(today);
    date.setDate(today.getDate() - (i * 7));
    
    // Format as M/D/YY (e.g., 2/26/25)
    const month = date.getMonth() + 1; // Months are 0-indexed
    const day = date.getDate();
    const year = date.getFullYear().toString().slice(-2); // Get last 2 digits
    
    categories.push(`${month}/${day}/${year}`);
  }
  
  return categories;
}

// Common x-axis categories for all charts
const categories = generateDateCategories();

// Define data for the metrics cards for each time period
const metricsCardsData = {
  "week": [
    {
      number: 8,
      percentage: 12,
      positive: true
    },
    {
      number: 15,
      percentage: -5,
      positive: false
    },
    {
      number: 4,
      percentage: 20,
      positive: true
    },
    {
      number: 32,
      percentage: 8,
      positive: true
    }
  ],
  "month": [
    {
      number: 23,
      percentage: 27,
      positive: true
    },
    {
      number: 86,
      percentage: 25,
      positive: true
    },
    {
      number: 70,
      percentage: 8.7,
      positive: true
    },
    {
      number: 9,
      percentage: 2.5,
      positive: false
    }
  ],
  "quarter": [
    {
      number: 65,
      percentage: 32,
      positive: true
    },
    {
      number: 142,
      percentage: 22,
      positive: true
    },
    {
      number: 37,
      percentage: -12,
      positive: false
    },
    {
      number: 254,
      percentage: 45,
      positive: true
    }
  ],
  "year": [
    {
      number: 245,
      percentage: 28,
      positive: true
    },
    {
      number: 520,
      percentage: -3,
      positive: false
    },
    {
      number: 128,
      percentage: 42,
      positive: true
    },
    {
      number: 980,
      percentage: 65,
      positive: true
    }
  ]
};

const timePeriodsData = {
  "week": {
    // Agency data (for combinedAgencyChart)
    "chart1": [42, 50, 31, 45], // Total
    "chart2": [28, 32, 18, 30], // City Economic Development
    "chart3": [15, 10, 5, 12], // EDO
    "chart4": [8, 6, 10, 9], // Chamber
    "chart5": [15, 12, 14, 18], // Downtown Association
    "chart6": [4, 2, 7, 6], // Consultant
    
    // Indicator charts
    "chart7": ["1:3.5", "1:4.2", "1:3.8", "1:4.5"], // Investment Ratio
    "chart8": [25, 28, 22, 24], // Business Count
    "chart11": [12, 15, 10, 14], // Leads
    "chart12": [8, 10, 7, 9]  // Projects
  },
  
  "month": {
    // Agency data (for combinedAgencyChart)
    "chart1": [32, 96, 82, 100], // Total
    "chart2": [24, 44, 16, 88], // City Economic Development
    "chart3": [1, 17, 3, 1], // EDO
    "chart4": [2, 10, 7, 6], // Chamber
    "chart5": [5, 25, 50, 5], // Downtown Association
    "chart6": [0, 0, 6, 0], // Consultant
    
    // Indicator charts
    "chart7": ["1:5", "1:5.1", "1:6", "1:6.5"], // Investment Ratio
    "chart8": [880, 882, 875, 880], // Business Count
    "chart11": [5, 6, 3, 1], // Leads
    "chart12": [44, 44, 49, 49]  // Projects
  },
  
  "quarter": {
    // Agency data (for combinedAgencyChart)
    "chart1": [120, 135, 142, 150], // Total
    "chart2": [80, 85, 78, 95], // City Economic Development
    "chart3": [25, 28, 30, 22], // EDO
    "chart4": [35, 38, 42, 40], // Chamber
    "chart5": [50, 48, 52, 55], // Downtown Association
    "chart6": [18, 20, 12, 15], // Consultant
    
    // Indicator charts
    "chart7": ["1:4.8", "1:5.2", "1:4.6", "1:5.0"], // Investment Ratio
    "chart8": [950, 975, 980, 1000], // Business Count
    "chart11": [18, 22, 20, 24], // Leads
    "chart12": [65, 70, 72, 68]  // Projects
  },
  
  "year": {
    // Agency data (for combinedAgencyChart)
    "chart1": [420, 480, 510, 550], // Total
    "chart2": [280, 320, 350, 380], // City Economic Development
    "chart3": [90, 85, 95, 100], // EDO
    "chart4": [110, 120, 100, 130], // Chamber
    "chart5": [150, 160, 170, 165], // Downtown Association
    "chart6": [60, 55, 65, 70], // Consultant
    
    // Indicator charts
    "chart7": ["1:5.5", "1:6.0", "1:5.8", "1:6.2"], // Investment Ratio
    "chart8": [1200, 1250, 1300, 1350], // Business Count
    "chart11": [75, 80, 85, 90], // Leads
    "chart12": [220, 230, 240, 250]  // Projects
  }
};

// Function to update metrics cards based on time period
function updateMetricsCards(timePeriod) {
  // Get all metrics cards
  const metricsCards = document.querySelectorAll('.metrics-card-content');
  
  // Define comparison text for each time period
  const comparisonText = {
    "week": "vs previous 7 days",
    "month": "vs previous 30 days",
    "quarter": "vs previous quarter",
    "year": "year over year"
  };
  
  // Update each metrics card with data from the selected time period
  metricsCards.forEach((card, index) => {
    // Get card elements
    const numberElement = card.querySelector('.metrics-card-number');
    const percentageElement = card.querySelector('.metrics-card-percentage');
    const percentageNumberElement = card.querySelector('.metrics-card-percentage-number');
    const changeElement = card.querySelector('.metrics-card-change');
    
    // Get data for this card
    const cardData = metricsCardsData[timePeriod][index];
    
    // Update number
    numberElement.textContent = cardData.number;
    
    // Update percentage and its styling
    percentageNumberElement.textContent = `${Math.abs(cardData.percentage)}%`;
    
    // Update arrow and class for positive/negative
    if (cardData.positive) {
      percentageElement.classList.remove('metrics-card-percentage-negative');
      percentageElement.classList.add('metrics-card-percentage-positive');
      percentageElement.innerHTML = `<div class="metrics-card-percentage-number">${Math.abs(cardData.percentage)}%</div>`;
    } else {
      percentageElement.classList.remove('metrics-card-percentage-positive');
      percentageElement.classList.add('metrics-card-percentage-negative');
      percentageElement.innerHTML = `<div class="metrics-card-percentage-number">${Math.abs(cardData.percentage)}%</div>`;
    }
    
    // Update comparison text
    changeElement.textContent = comparisonText[timePeriod];
    
    // Add a subtle animation for the update
    card.classList.add('metrics-card-updating');
    setTimeout(() => {
      card.classList.remove('metrics-card-updating');
    }, 500);
  });
}

// Process the ratio data for all time periods
function processAllTimePeriodRatioData(data) {
  const processedData = JSON.parse(JSON.stringify(data));
  
  // Process chart7 for all time periods
  for (const period in processedData) {
    if (processedData[period] && processedData[period].chart7) {
      processedData[period].chart7 = processedData[period].chart7.map(val => parseRatio(val));
    }
  }
  
  return processedData;
}

// Process all the data up front
const processedTimePeriodsData = processAllTimePeriodRatioData(timePeriodsData);

// Main charts initialization code
document.addEventListener('DOMContentLoaded', function() {
  // Store charts in a global array for easy access
  const charts = [];

  // Generate date categories based on the current date
  function generateDateCategories() {
    const today = new Date();
    const categories = [];
    
    // Get the 4 weeks, going backward from today
    for (let i = 3; i >= 0; i--) {
      // Clone today's date and subtract weeks
      const date = new Date(today);
      date.setDate(today.getDate() - (i * 7));
      
      // Format as M/D/YY (e.g., 2/26/25)
      const month = date.getMonth() + 1; // Months are 0-indexed
      const day = date.getDate();
      const year = date.getFullYear().toString().slice(-2); // Get last 2 digits
      
      categories.push(`${month}/${day}/${year}`);
    }
    
    return categories;
  }

  // Common x-axis categories for all charts
  const categories = generateDateCategories();

  // Chart colors
  const chartColors = {
    chart1: '#008FFB',
    chart2: '#00E396',
    chart3: '#FEB019',
    chart4: '#FF4560',
    chart5: '#775DD0',
    chart6: '#2E93fA',
    chart7: '#4CAF50',
    chart8: '#9C27B0',
    chart11: '#E91E63',
    chart12: '#3F51B5'
  };

  // Chart titles
  const chartTitles = {
    chart7: 'Investment Ratio (Public to Private)',
    chart8: 'Business Count',
    chart11: 'Leads',
    chart12: 'Projects'
  };

  // Default time period is 'month'
  let currentTimePeriod = 'month';

  // Initialize Combined Agency Chart
  function initCombinedAgencyChart() {
    const agencyChartIds = ['chart1', 'chart2', 'chart3', 'chart4', 'chart5', 'chart6'];
    const agencyNames = [
      'Total', 
      'City Economic Development', 
      'EDO', 
      'Chamber', 
      'Downtown Association', 
      'Consultant'
    ];
    
    // Create series array for the combined chart using the current time period data
    const combinedSeries = agencyChartIds.map((chartId, index) => {
      return {
        name: agencyNames[index],
        data: processedTimePeriodsData[currentTimePeriod][chartId],
        color: chartColors[chartId]
      };
    });
    
    // Options for the combined chart
    const options = {
      series: combinedSeries,
      chart: {
        height: 540,
        type: 'line',
        zoom: {
          enabled: false
        },
        toolbar: {
          show: false
        },
        animations: {
          enabled: true,
          easing: 'easeinout',
          speed: 800
        }
      },
      dataLabels: {
        enabled: false
      },
      stroke: {
        curve: 'straight',
        width: 2.5
      },
      title: {
        text: '',
        align: 'left',
        style: {
          fontSize: '16px',
          fontWeight: 'bold'
        }
      },
      grid: {
        row: {
          colors: ['#f3f3f3', 'transparent'],
          opacity: 0.5
        },
        borderColor: '#f1f1f1'
      },
      xaxis: {
        categories: categories,
        labels: {
          style: {
            fontSize: '12px'
          }
        }
      },
      yaxis: {
        labels: {
          style: {
            fontSize: '12px'
          },
          formatter: function(val) {
            return Number.isInteger(val) ? val.toString() : val.toFixed(1);
          }
        }
      },
      legend: {
        position: 'top',
        horizontalAlign: 'right',
        fontSize: '12px'
      },
      markers: {
        size: 4,
        hover: {
          size: 6
        }
      },
      tooltip: {
        shared: true,
        intersect: false
      }
    };

    // Create the combined chart
    const combinedChart = new ApexCharts(document.querySelector('#combinedAgencyChart'), options);
    combinedChart.render();
    
    // Add this chart to the charts array
    charts.push({
      id: 'combinedAgencyChart',
      chart: combinedChart
    });
  }

  // Initialize Individual Indicator Charts (7, 8, 11, 12)
  function initIndicatorCharts() {
    // Charts to initialize
    const chartIds = ['chart7', 'chart8', 'chart11', 'chart12'];
    
    // Initialize each indicator chart
    chartIds.forEach(chartId => {
      // Special handling for chart7 (ratio chart)
      if (chartId === 'chart7') {
        initRatioChart(chartId);
      } else {
        initRegularChart(chartId);
      }
    });
  }

  // Initialize the special ratio chart (chart7)
  function initRatioChart(chartId) {
    // Transform ratio data into public and private parts
    const publicData = [];
    const privateData = [];
    
    processedTimePeriodsData[currentTimePeriod][chartId].forEach(ratio => {
      // Calculate percentage split
      const total = 1 + 1/ratio;
      const publicPct = (1/total) * 100;
      const privatePct = ((1/ratio)/total) * 100;
      
      publicData.push(publicPct);
      privateData.push(privatePct);
    });
    
    const options = {
      series: [{
        name: 'Public Investment',
        data: publicData
      }, {
        name: 'Private Investment',
        data: privateData
      }],
      chart: {
        type: 'bar',
        height: 250,
        stacked: true,
        stackType: '100%',
        toolbar: {
          show: false
        },
        animations: {
          enabled: true,
          easing: 'easeinout',
          speed: 800
        }
      },
      colors: ['#4CAF50', '#8BC34A'],
      plotOptions: {
        bar: {
          horizontal: false,
          columnWidth: '60%',
        }
      },
      dataLabels: {
        enabled: true,
        formatter: function(val, opt) {
          const seriesIndex = opt.seriesIndex;
          const dataPointIndex = opt.dataPointIndex;
          const ratio = processedTimePeriodsData[currentTimePeriod][chartId][dataPointIndex];
          
          if (seriesIndex === 0) {
            return '$1';
          } else {
            return '$' + (1/ratio).toFixed(1);
          }
        },
        style: {
          fontSize: '11px',
          fontWeight: 'normal',
          colors: ['#000', '#000']
        }
      },
      stroke: {
        width: 1,
        colors: ['#fff']
      },
      title: {
        text: chartTitles[chartId],
        align: 'left',
        style: {
          fontSize: '14px'
        }
      },
      grid: {
        row: {
          colors: ['#f3f3f3', 'transparent'],
          opacity: 0.5
        },
        borderColor: '#f1f1f1'
      },
      xaxis: {
        categories: categories,
        labels: {
          style: {
            fontSize: '10px'
          }
        }
      },
      yaxis: {
        labels: {
          style: {
            fontSize: '10px'
          },
          formatter: function(val) {
            return val.toFixed(0) + '%';
          }
        }
      },
      tooltip: {
        shared: true,
        intersect: false,
        y: {
          formatter: function(val, opt) {
            if (opt.seriesIndex === 0) {
              return 'Public: $1 (' + val.toFixed(1) + '%)';
            } else {
              const dataPointIndex = opt.dataPointIndex;
              const ratio = processedTimePeriodsData[currentTimePeriod][chartId][dataPointIndex];
              return 'Private: $' + (1/ratio).toFixed(1) + ' (' + val.toFixed(1) + '%)';
            }
          }
        }
      },
      legend: {
        position: 'top',
        fontSize: '12px'
      }
    };

    const chart = new ApexCharts(document.querySelector(`#${chartId}`), options);
    chart.render();
    charts.push({
      id: chartId,
      chart: chart
    });
  }

  // Initialize regular charts (8, 11, 12)
  function initRegularChart(chartId) {
    const options = {
      series: [{
        name: chartTitles[chartId],
        data: processedTimePeriodsData[currentTimePeriod][chartId]
      }],
      chart: {
        height: 250,
        type: 'line',
        zoom: {
          enabled: false
        },
        toolbar: {
          show: false
        },
        animations: {
          enabled: true,
          easing: 'easeinout',
          speed: 800
        }
      },
      colors: [chartColors[chartId]],
      dataLabels: {
        enabled: false
      },
      stroke: {
        curve: 'straight',
        width: 2.5
      },
      title: {
        text: chartTitles[chartId],
        align: 'left',
        style: {
          fontSize: '14px'
        }
      },
      grid: {
        row: {
          colors: ['#f3f3f3', 'transparent'],
          opacity: 0.5
        },
        borderColor: '#f1f1f1'
      },
      xaxis: {
        categories: categories,
        labels: {
          style: {
            fontSize: '10px'
          }
        }
      },
      yaxis: {
        labels: {
          style: {
            fontSize: '10px'
          },
          formatter: function(val) {
            return Number.isInteger(val) ? val.toString() : val.toFixed(1);
          }
        }
      }
    };

    const chart = new ApexCharts(document.querySelector(`#${chartId}`), options);
    chart.render();
    charts.push({
      id: chartId,
      chart: chart
    });
  }

  // Initialize Time Period Selector
  function initTimePeriodSelector() {
    document.querySelectorAll('.time-btn').forEach(button => {
      button.addEventListener('click', function() {
        // Update active button style
        document.querySelectorAll('.time-btn').forEach(btn => {
          btn.classList.remove('active');
        });
        this.classList.add('active');
        
        // Get selected time period
        currentTimePeriod = this.getAttribute('data-period');

        // Remove active state from date inputs
        document.getElementById('startDate').classList.remove('active-date-input');
        document.getElementById('endDate').classList.remove('active-date-input');
        
        // Generate new x-axis categories based on the selected time period
        const newCategories = generateTimeBasedCategories(currentTimePeriod);
        
        // Update all charts with new data and categories for the selected time period
        charts.forEach(chartObj => {
          // First update the x-axis categories for all charts
          chartObj.chart.updateOptions({
            xaxis: {
              categories: newCategories
            }
          });
          
          // Then update the series data appropriately for each chart type
          if (chartObj.id === 'combinedAgencyChart') {
            // Update the combined agency chart
            const agencyChartIds = ['chart1', 'chart2', 'chart3', 'chart4', 'chart5', 'chart6'];
            const agencyNames = [
              'Total', 
              'City Economic Development', 
              'EDO', 
              'Chamber', 
              'Downtown Association', 
              'Consultant'
            ];
            
            const updatedSeries = agencyChartIds.map((chartId, index) => {
              return {
                name: agencyNames[index],
                data: processedTimePeriodsData[currentTimePeriod][chartId]
              };
            });
            
            chartObj.chart.updateSeries(updatedSeries);
          } else if (chartObj.id === 'chart7') {
            // Update the ratio chart (chart7)
            const publicData = [];
            const privateData = [];
            
            processedTimePeriodsData[currentTimePeriod][chartObj.id].forEach(ratio => {
              // Calculate percentage split
              const total = 1 + 1/ratio;
              const publicPct = (1/total) * 100;
              const privatePct = ((1/ratio)/total) * 100;
              
              publicData.push(publicPct);
              privateData.push(privatePct);
            });
            
            chartObj.chart.updateSeries([
              {
                name: 'Public Investment',
                data: publicData
              },
              {
                name: 'Private Investment',
                data: privateData
              }
            ]);
          } else {
            // Update regular charts (8, 11, 12)
            chartObj.chart.updateSeries([{
              data: processedTimePeriodsData[currentTimePeriod][chartObj.id]
            }]);
          }
        });

        // Update the metrics cards with data for the selected time period
        updateMetricsCards(currentTimePeriod);

      });
    });
  }

  // Initialize Navigation Menu
  function initNavigationMenu() {
    // Handle main menu items with sub-menus
    document.querySelectorAll('.menu-item').forEach(menuItem => {
      const subMenu = menuItem.parentElement.querySelector('.sub-menu');
      if (subMenu) {
        menuItem.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Toggle the sub-menu visibility
          if (subMenu.style.display === 'none' || subMenu.style.display === '') {
            subMenu.style.display = 'block';
            // Rotate chevron down
            const chevron = menuItem.querySelector('.action-icon');
            if (chevron) {
              chevron.style.transform = 'rotate(180deg)';
            }
          } else {
            subMenu.style.display = 'none';
            // Rotate chevron back
            const chevron = menuItem.querySelector('.action-icon');
            if (chevron) {
              chevron.style.transform = 'rotate(0deg)';
            }
          }
        });
      }
    });
  }

  // Initialize all components
  initCombinedAgencyChart();
  initIndicatorCharts();
  initTimePeriodSelector();
  initInlineDateRangeSelector();
  initNavigationMenu();
});
  </script>
</body>
</html>